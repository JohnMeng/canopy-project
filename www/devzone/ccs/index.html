<html>
<head>
    <title>Canopy - Developer Zone - Cloud Server</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="../../canopy_project.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,700|ABeeZee|Titillium+Web:200,300,400,700' rel='stylesheet' type='text/css'>
    <link href='../../canopy_project.css' rel='stylesheet' type='text/css'>
    <script type='text/javascript' src='../../3rdparty/shjs/sh_main.min.js'></script>
    <link type='text/css' rel='stylesheet' href='../../3rdparty/shjs/sh_style_greg.css'>
    <link href='hammock-custom.css' rel='stylesheet' type='text/css'>
<script>
function get_scroll_y() {
    return window.pageYOffset || document.body.scrollTop || document.html.scrollTop;
}
function get_element_scroll_y(id) {
    return document.getElementById(id).offsetTop;
}

function update_scroll() {
    var y = get_scroll_y();

        document.getElementById('toc_overview').style.fontWeight = '';document.getElementById('toc_overview').style.backgroundColor = '';document.getElementById('toc_about').style.fontWeight = '';document.getElementById('toc_about').style.backgroundColor = '';document.getElementById('toc_hosting_options').style.fontWeight = '';document.getElementById('toc_hosting_options').style.backgroundColor = '';document.getElementById('toc_installation').style.fontWeight = '';document.getElementById('toc_installation').style.backgroundColor = '';document.getElementById('toc_installing_dependencies').style.fontWeight = '';document.getElementById('toc_installing_dependencies').style.backgroundColor = '';document.getElementById('toc_configuring_and_running').style.fontWeight = '';document.getElementById('toc_configuring_and_running').style.backgroundColor = '';document.getElementById('toc_configuration').style.fontWeight = '';document.getElementById('toc_configuration').style.backgroundColor = '';document.getElementById('toc_config_priority').style.fontWeight = '';document.getElementById('toc_config_priority').style.backgroundColor = '';document.getElementById('toc_configuration_settings').style.fontWeight = '';document.getElementById('toc_configuration_settings').style.backgroundColor = '';document.getElementById('toc_config_file_example').style.fontWeight = '';document.getElementById('toc_config_file_example').style.backgroundColor = '';document.getElementById('toc_environment_override_example').style.fontWeight = '';document.getElementById('toc_environment_override_example').style.backgroundColor = '';document.getElementById('toc_command-line_override_example').style.fontWeight = '';document.getElementById('toc_command-line_override_example').style.backgroundColor = '';document.getElementById('toc_checking_the_configuration').style.fontWeight = '';document.getElementById('toc_checking_the_configuration').style.backgroundColor = '';
    if (0) {
    }
    
            else if (y + 32 > get_element_scroll_y('checking_the_configuration')) {
                document.getElementById('toc_checking_the_configuration').style.fontWeight = "bold";
                document.getElementById('toc_checking_the_configuration').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('command-line_override_example')) {
                document.getElementById('toc_command-line_override_example').style.fontWeight = "bold";
                document.getElementById('toc_command-line_override_example').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('environment_override_example')) {
                document.getElementById('toc_environment_override_example').style.fontWeight = "bold";
                document.getElementById('toc_environment_override_example').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('config_file_example')) {
                document.getElementById('toc_config_file_example').style.fontWeight = "bold";
                document.getElementById('toc_config_file_example').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('configuration_settings')) {
                document.getElementById('toc_configuration_settings').style.fontWeight = "bold";
                document.getElementById('toc_configuration_settings').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('config_priority')) {
                document.getElementById('toc_config_priority').style.fontWeight = "bold";
                document.getElementById('toc_config_priority').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('configuration')) {
                document.getElementById('toc_configuration').style.fontWeight = "bold";
                document.getElementById('toc_configuration').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('configuring_and_running')) {
                document.getElementById('toc_configuring_and_running').style.fontWeight = "bold";
                document.getElementById('toc_configuring_and_running').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('installing_dependencies')) {
                document.getElementById('toc_installing_dependencies').style.fontWeight = "bold";
                document.getElementById('toc_installing_dependencies').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('installation')) {
                document.getElementById('toc_installation').style.fontWeight = "bold";
                document.getElementById('toc_installation').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('hosting_options')) {
                document.getElementById('toc_hosting_options').style.fontWeight = "bold";
                document.getElementById('toc_hosting_options').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('about')) {
                document.getElementById('toc_about').style.fontWeight = "bold";
                document.getElementById('toc_about').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('overview')) {
                document.getElementById('toc_overview').style.fontWeight = "bold";
                document.getElementById('toc_overview').style.backgroundColor = "#d0d0d0";
            }
            
}
window.onload = function() {
    window.addEventListener("scroll", update_scroll);
}
</script>

    <script>
    $(function() {
        sh_highlightDocument('../../3rdparty/shjs/', '.min.js');
    });
    </script>
</head>
<!--body onload="sh_highlightDocument('../../3rdparty/shjs/', '.min.js');"-->
<body>
<div class=main-outer>
    <div class='bg-white centered'>
        <script> 
            var RELATIVE_PATH = "../../";
            RenderTopbar("devzone");
        </script>
    </div>

    <div class='bg-lightgray banner-thin centered' >
        <div class='l'>
            <span class='logo-in-text' style='color:#ffffff'>Canopy</span> Server
        </div>
    </div>
</div>
    <div class='hammock-toc-outer'><div class='hammock-toc-title'>Canopy Server</div><div id='toc_overview' class='hammock-toc-chapter'><a href='#overview'>Overview</a></div><div id='toc_about' class='hammock-toc-section'><a href='#about'>About</a></div><div id='toc_hosting_options' class='hammock-toc-section'><a href='#hosting_options'>Hosting Options</a></div><div id='toc_installation' class='hammock-toc-chapter'><a href='#installation'>Installation</a></div><div id='toc_installing_dependencies' class='hammock-toc-section'><a href='#installing_dependencies'>Installing Dependencies</a></div><div id='toc_configuring_and_running' class='hammock-toc-section'><a href='#configuring_and_running'>Configuring and Running</a></div><div id='toc_configuration' class='hammock-toc-chapter'><a href='#configuration'>Configuration</a></div><div id='toc_config_priority' class='hammock-toc-section'><a href='#config_priority'>Config Priority</a></div><div id='toc_configuration_settings' class='hammock-toc-section'><a href='#configuration_settings'>Configuration Settings</a></div><div id='toc_config_file_example' class='hammock-toc-section'><a href='#config_file_example'>Config File Example</a></div><div id='toc_environment_override_example' class='hammock-toc-section'><a href='#environment_override_example'>Environment Override Example</a></div><div id='toc_command-line_override_example' class='hammock-toc-section'><a href='#command-line_override_example'>Command-line Override Example</a></div><div id='toc_checking_the_configuration' class='hammock-toc-section'><a href='#checking_the_configuration'>Checking the Configuration</a></div></div>
    <div class=hammock-doc-outer>

            <div class=hammock-chapter-outer>
                <a class=hammock-a-name id=overview name=overview></a>
                <div class=hammock-chapter-title>
                    Overview
                </div>
                <div class=hammock-chapter-contents>
                    
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=about name=about></a>
            <div class=hammock-section-title>
                About
            </div>
            <div class=hammock-section-contents>
                
        The <b>Canopy Server</b> is a server-side program written in GoLang.  It serves
        the <a href="../restapi/canopy_api.html" target="_blank" >Canopy REST API</a> and Canopy
        Websocket API.  Additionally, it can be configured to serve the Canopy
        Device Manager which provides a web-based frontend.
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=hosting_options name=hosting_options></a>
            <div class=hammock-section-title>
                Hosting Options
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Hosted by Us
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                The Canopy team operates two large-scale deployments of the Canopy
                Server.  These are hosted in a world-class datacenter with high
                availability.  
                <ul><li>
                        <a href="http://sandbox.canopy.link" target="_blank" >
                        <b>http://sandbox.canopy.link</b></a>: Free deployment for
                        learning Canopy and developing smart products.
                    </li>
                    <li>
                        <a href="http://sandbox.canopy.link" target="_blank" >
                        <b>http://ccs.canopy.link</b></a>: Enterprise-grade
                        deployment for shipping products.
                    </li>
                </ul>
                Learn more about these deployments on our <a href="http://canopy.link/services.html" target="_blank" >Services</a> page.
            </p>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Hosted by You
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                The Canopy Server is completely open source and licensed under
                the highly-permisive Apache v2.0 license.  It is easy to deploy
                your own instance of the server by following the <a href=#installation>I<!---->n<!---->s<!---->t<!---->a<!---->l<!---->l<!---->a<!---->t<!---->i<!---->o<!---->n<!----></a>
                instructions in this document.
            </p>
        
            </div>
        </div>

    
            </div>
        </div>

                </div>
            </div>


            <div class=hammock-chapter-outer>
                <a class=hammock-a-name id=installation name=installation></a>
                <div class=hammock-chapter-title>
                    Installation
                </div>
                <div class=hammock-chapter-contents>
                    
    <p>
        This section contains instructions for installing the Canopy Server
        from source on a fresh Ubuntu 14.04 LTS machine.  This may be installed
        in a public cloud, private cloud, local network, or even on your
        laptop!
    </p>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=installing_dependencies name=installing_dependencies></a>
            <div class=hammock-section-title>
                Installing Dependencies
            </div>
            <div class=hammock-section-contents>
                
        <p>
            Canopy requires Cassandra, Oracle Java 1.7, and Go-lang in order to
            run.
        </p>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Installing Cassandra
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                Using the text editor of your choice, edit
                <span class=hammock-icode>/etc/apt/sources.list.d/cassandra.sources.list</span>:
            </p>
            <pre class='hammock-code'>sudo vim /etc/apt/sources.list.d/cassandra.sources.list</pre>
            <p>
                Add the following line:
            </p>
            <pre class='hammock-code'>deb http://debian.datastax.com/community stable main</pre>
            <p>
                Save and exit.  Then run:
            </p>
            <pre class='hammock-code'>curl -L http://debian.datastax.com/debian/repo_key | sudo apt-key add -
sudo apt-get update
sudo apt-get install -y cassandra=2.0.7</pre>
        
            </div>
        </div>

        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Installing Oracle Java 1.7
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                Run:
            </p>
            <pre class='hammock-code'>sudo apt-get install -y python-software-properties
sudo add-apt-repository ppa:webupd8team/java</pre>
            <p>
                Press ENTER when prompted.  The run:
            </p>
            <pre class='hammock-code'>sudo apt-get update
sudo apt-get install -y oracle-java7-installer</pre>
            <p>
                When prompted, press ENTER.  Then select "Yes" and press ENTER.
            </p>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Installing Go-lang
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                Run:
            </p>
            <pre class='hammock-code'>sudo apt-get install -y golang git make mercurial</pre>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Installing Canopy Server
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                Clone the repository:
            </p>
            <pre class='hammock-code'>git clone https://github.com/canopy-project/canopy-cloud</pre>
            <p>
                Build the project:
            </p>
            <pre class='hammock-code'>cd canopy-cloud
make</pre>
            <p>
                You should see this output:
            </p>
            <pre class='hammock-output'>make -C src/canopy go_get_deps
make[1]: Entering directory `/home/ubuntu/canopy-cloud/src/canopy'
mkdir -p ~/.canopy/golang
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go get code.google.com/p/go.net/websocket
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go get github.com/gocql/gocql
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go get github.com/gorilla/sessions
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go get github.com/gorilla/context
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go get github.com/gorilla/mux
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go get github.com/sendgrid/sendgrid-go
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go get code.google.com/p/go.crypto/bcrypt
make[1]: Leaving directory `/home/ubuntu/canopy-cloud/src/canopy'
make -C src/canopy all
make[1]: Entering directory `/home/ubuntu/canopy-cloud/src/canopy'
mkdir -p ~/.canopy/golang
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go build canopy-cloud-service.go canopy_cloud.go canopy_json.go
mkdir -p build/
mv canopy-cloud-service build/
mkdir -p ~/.canopy/golang
GOPATH=$(cd ~/.canopy/golang; pwd):$(cd ../../; pwd) go build canopy_cmd.go
mkdir -p build/
mv canopy_cmd build/canodevtool
make[1]: Leaving directory `/home/ubuntu/canopy-cloud/src/canopy'</pre>
            <p>
                Install it:
            </p>
            <pre class='hammock-code'>sudo make install</pre>
            <p>
                You should see this output:
            </p>

            <pre class='hammock-output'>src/canopy install
make[1]: Entering directory `/home/ubuntu/canopy-cloud/src/canopy'
cp build/canopy-cloud-service build/canodevtool /usr/local/bin
cp ../../scripts/canopy-cloud-service /etc/init.d
mkdir -p /etc/canopy
cp ../../scripts/ccs-env.sh /etc/canopy
../../scripts/create-canopy-group-user.sh
id: canopy: no such user
Adding group `canopy' (GID 114) ...
Done.
id: canopy: no such user
Adding system user `canopy' (UID 108) ...
Adding new user `canopy' (UID 108) with group `canopy' ...
Not creating home directory `/home/canopy'.
mkdir -p /var/log/canopy
touch /var/log/canopy/ccs.log
touch /var/log/canopy/ccs-errors.log
chown canopy /var/log/canopy
chgrp canopy /var/log/canopy
chown canopy /var/log/canopy/ccs.log
chgrp canopy /var/log/canopy/ccs.log
chown canopy /var/log/canopy/ccs-errors.log
chgrp canopy /var/log/canopy/ccs-errors.log
make[1]: Leaving directory `/home/ubuntu/canopy-cloud/src/canopy'</pre>
            <p>
                Start Cassandra running:
            </p>
            <pre class='hammock-code'>sudo cassandra</pre>
            <p>
                You should see a bunch of text scroll, ending with:
            </p>
            <pre class='hammock-output'>INFO 17:24:59,576 Completed flushing /var/lib/cassandra/data/system/local/system-local-jb-3-Data.db (114 bytes) for commitlog position ReplayPosition(segmentId=1410197098396, position=91604)
INFO 17:24:59,644 CFS(Keyspace='system', ColumnFamily='local') liveRatio is 27.44988344988345 (just-counted was 3.515151515151515).  calculation took 5ms for 257 cells
INFO 17:24:59,644 Enqueuing flush of Memtable-local@414544706(10098/277188 serialized/live bytes, 259 ops)
INFO 17:24:59,645 Writing Memtable-local@414544706(10098/277188 serialized/live bytes, 259 ops)
INFO 17:24:59,677 Completed flushing /var/lib/cassandra/data/system/local/system-local-jb-4-Data.db (5275 bytes) for commitlog position ReplayPosition(segmentId=1410197098396, position=103603)
INFO 17:24:59,693 Compacting [SSTableReader(path='/var/lib/cassandra/data/system/local/system-local-jb-1-Data.db'), SSTableReader(path='/var/lib/cassandra/data/system/local/system-local-jb-3-Data.db'), SSTableReader(path='/var/lib/cassandra/data/system/local/system-local-jb-4-Data.db'), SSTableReader(path='/var/lib/cassandra/data/system/local/system-local-jb-2-Data.db')]
INFO 17:24:59,780 Node localhost/127.0.0.1 state jump to normal</pre>
            <p>
                Press ENTER to return to the command-line.
            </p>
            <p>
                Create the database:
            </p>
            <pre class='hammock-code'>canodevtool create-db</pre>

            <p>
                Don't worry if there are errors.  You should see this output:
            </p>

            <pre class='hammock-output'>Error opening file /var/log/canopy/ccs.log:  open /var/log/canopy/ccs.log: permission denied
Falling back to STDOUT for logging
WARN 2014/09/08 17:28:24 cass_datalayer.go:340: (IGNORED)  line 6:19 mismatched input '(' expecting ')'</pre>
        
            </div>
        </div>
    
            </div>
        </div>
    
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=configuring_and_running name=configuring_and_running></a>
            <div class=hammock-section-title>
                Configuring and Running
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Configuring the Cloud Server
            </div>
            <div class=hammock-subsection-contents>
                
            One last step before running the Canopy Cloud Service.  We must configure it.
            Edit the file: 
            <pre class='hammock-code'>/etc/canopy/server.conf</pre>
            <p>
                Change the <span class=hammock-icode>"hostname"</span> to match the IP address or hostname of your server.
            </p>
            <p>
                There a many other configuration options you can modify.  Learn
                more about configuring the server in the <a href=#configuration>C<!---->o<!---->n<!---->f<!---->i<!---->g<!---->u<!---->r<!---->a<!---->t<!---->i<!---->o<!---->n<!----></a> chapter.
            </p>
        
            </div>
        </div>

        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Starting the Canopy Server
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                Now, you can start the Canopy Server
            </p>
            <pre class='hammock-code'>sudo /etc/init.d/canopy-cloud-service start</pre>

            <p>
                To check that it is working, go to
                <span class=hammock-icode>http://&lt;ip_address&gt;/api/info</span> in your web
                browser.  You should see something like the following response:
            </p>
            <pre class='hammock-code'>{
    "service-name" : "Canopy Cloud Service",
    "version" : "0.9.0-beta"
}</pre>
            <p>
                If you see anything other than that, there was most likely a
                problem.  You can view the log file by typing:
            </p>

            <pre class='hammock-code'>cat /var/log/canopy/canopy-server.log</pre>
        
            </div>
        </div>
    
            </div>
        </div>

                </div>
            </div>


            <div class=hammock-chapter-outer>
                <a class=hammock-a-name id=configuration name=configuration></a>
                <div class=hammock-chapter-title>
                    Configuration
                </div>
                <div class=hammock-chapter-contents>
                    
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=config_priority name=config_priority></a>
            <div class=hammock-section-title>
                Config Priority
            </div>
            <div class=hammock-section-contents>
                
        <p>
            The Canopy Server's configuration is read from one or more config
            files.  Config settings can be overridden with environment
            variables and command-line parameters.
        </p>
        <p>
            This table shows the ordering in which configuration is read:
        </p>
        <table cellspacing=0 cellpadding=0 border=0 class=hammock-tbl>
            <tr>
                <td  class=hammock-tbl-header>
                    Config Source
                </td>
                <td  class=hammock-tbl-header>
                    Order
                </td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>Compiled Defaults</span></td>
                <td >1 - Lowest priority (read first)</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>/etc/canopy/server.conf</span></td>
                <td >2</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>$HOME/.canopy/server.conf</span></td>
                <td >3</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>$CANOPY_SERVER_CONFIG_FILE</span></td>
                <td >4</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>Environment Variables</span></td>
                <td >5</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>Command-line Parameters</span></td>
                <td >6 - Highest priority (read last)</td>
            </tr>
        </table>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=configuration_settings name=configuration_settings></a>
            <div class=hammock-section-title>
                Configuration Settings
            </div>
            <div class=hammock-section-contents>
                
        <table cellspacing=0 cellpadding=0 border=0 class=hammock-tbl>
            <tr>
                <td  class=hammock-tbl-header>
                    JSON Key
                </td>
                <td  class=hammock-tbl-header>
                    Environment Variable
                </td>
                <td  class=hammock-tbl-header>
                    Command-line Option
                </td>
                <td  class=hammock-tbl-header>
                    Description
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"allow-anon-devices"</span></td>
                <td nowrap><span class=hammock-icode>ALLOW_ANON_DEVICES</span></td>
                <td nowrap><span class=hammock-icode>--allow-anon-devices=</span></td>
                <td >
                    If <span class=hammock-icode>true</span>, allow anonymous devices to post
                    data to the server.  If <span class=hammock-icode>false</span>, require that
                    every device has an associate User Account.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>true</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"allow-origin"</span></td>
                <td nowrap><span class=hammock-icode>CCS_ALLOW_ORIGIN</span></td>
                <td nowrap><span class=hammock-icode>--allow-origin=</span></td>
                <td >
                    Domains to include in the "allow-origin" header of HTTP
                    responses.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>""</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"forward-other-hosts"</span></td>
                <td nowrap><span class=hammock-icode>CCS_FORWARD_OTHER_HOSTS</span></td>
                <td nowrap><span class=hammock-icode>--forward-other-hosts=</span></td>
                <td >
                    The Canopy Server includes a proxy server that forwards
                    along all HTTP requests to other hostnames.  This specifies
                    the destination URL for these requests.  If
                    <span class=hammock-icode>""</span> then forwarding will be disabled.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>""</span>.
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"hostname"</span></td>
                <td nowrap><span class=hammock-icode>CCS_HOSTNAME</span></td>
                <td nowrap><span class=hammock-icode>--hostname=</span></td>
                <td >
                    Virtual hostname for Canopy Server.  This option is
                    required.  HTTP requests to other hosts will be forwarded
                    to the <span class=hammock-icode>"forward-other-hosts"</span>.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>""</span>.
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"http-port"</span></td>
                <td nowrap><span class=hammock-icode>CCS_HTTP_PORT</span></td>
                <td nowrap><span class=hammock-icode>--http-port=</span></td>
                <td >
                    HTTP port to listen on.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>80</span>.
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"js-client-path"</span></td>
                <td nowrap><span class=hammock-icode>CCS_JS_CLIENT_PATH</span></td>
                <td nowrap><span class=hammock-icode>--js-client-path=</span></td>
                <td >
                    Local filesystem path to the <span class=hammock-icode>canopy-js-client/</span>
                    project.
                    This must be configured to enable the Canopy Device
                    Manager.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>""</span>.
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"log-file"</span></td>
                <td nowrap><span class=hammock-icode>CCS_LOG_FILE</span></td>
                <td nowrap><span class=hammock-icode>--log-file=</span></td>
                <td >
                    Location of log file on local filesystem.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>"/var/log/canopy/canopy-server.log"</span>.
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"production-secret"</span></td>
                <td nowrap><span class=hammock-icode>CCS_PRODUCTION_SECRET</span></td>
                <td nowrap><span class=hammock-icode>--production-secret=</span></td>
                <td >
                    Secure secret string that must not be made public and
                    should be different for every server.  This is used to
                    secure session cookies.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>""</span>.
                    </p>
                </td>
            </tr>
            <tr>
                <td nowrap><span class=hammock-icode>"web-manager-path"</span></td>
                <td nowrap><span class=hammock-icode>CCS_WEB_MANAGER_PATH</span></td>
                <td nowrap><span class=hammock-icode>--web-manager-path=</span></td>
                <td >
                    Local filesystem path to the <span class=hammock-icode>canopy-app/</span>
                    project.
                    This must be configured to enable the Canopy Device
                    Manager.
                    <p>
                        <b>Default:</b> <span class=hammock-icode>""</span>.
                    </p>
                </td>
            </tr>
        </table>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=config_file_example name=config_file_example></a>
            <div class=hammock-section-title>
                Config File Example
            </div>
            <div class=hammock-section-contents>
                
        <pre class='hammock-code'>{
    "allow-anon-devices" : false,
    "allow-origin" : "sandbox.canopy.link myiotapp.com",
    "forward-other-hosts" : "http://canopy.link",
    "http-port" : 80,
    "hostname" : "sandbox.canopy.link",
    "js-client-path" : "/home/ubuntu/canopy-js-client",
    "production-secret" : "my production secret",
    "web-manager-path" : "/home/ubuntu/canopy-app",
}</pre>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=environment_override_example name=environment_override_example></a>
            <div class=hammock-section-title>
                Environment Override Example
            </div>
            <div class=hammock-section-contents>
                
        For example, to run the Canopy Server as a non-root user, you might use:
        <pre class='hammock-code'>CCS_HTTP_PORT=8080 CCS_LOG_FILE="ccs.log" /usr/local/bin/canopy/canopy-server</pre>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=command-line_override_example name=command-line_override_example></a>
            <div class=hammock-section-title>
                Command-line Override Example
            </div>
            <div class=hammock-section-contents>
                
        An alternative way to run the Canopy Server as a non-root user is:
        <pre class='hammock-code'>/usr/local/bin/canopy/canopy-server --http-port=8080 --log-file="ccs.log"</pre>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=checking_the_configuration name=checking_the_configuration></a>
            <div class=hammock-section-title>
                Checking the Configuration
            </div>
            <div class=hammock-section-contents>
                
        <p>
            You can check the configuration of a running Canopy Server using
            the <span class=hammock-icode>/api/info</span> endpoint.  For example:
        </p>
        <p>
            <a href="http://sandbox.canopy.link/api/info" target="_blank" ><b>http://sandbox.canopy.link/api/info</b></a>
        </p>
        <p>
            Additionally, the log file may contain a dump of all configuration
            settings when the server starts up:
        </p>
        <pre class='hammock-code'>tail -f /var/log/canopy-server.log</pre>
    
            </div>
        </div>

                </div>
            </div>

</div>
    <script> 
        RenderFooter();
    </script>
</body>
</html>

