<!DOCTYPE html>
<html>
<head>
    <title>Canopy - Developer Zone - REST API</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="../../canopy_project.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,700|ABeeZee|Titillium+Web:200,300,400,700' rel='stylesheet' type='text/css'>
    <link href='../../canopy_project.css' rel='stylesheet' type='text/css'>
    <script type='text/javascript' src='../../3rdparty/shjs/sh_main.min.js'></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <link type='text/css' rel='stylesheet' href='../../3rdparty/shjs/sh_style_greg.css'>
    <link href='hammock-custom.css' rel='stylesheet' type='text/css'>
<script>
function get_scroll_y() {
    return window.pageYOffset || document.body.scrollTop || document.html.scrollTop;
}
function get_element_scroll_y(id) {
    return document.getElementById(id).offsetTop;
}

function update_scroll() {
    var y = get_scroll_y();

        document.getElementById('toc_authentication').style.fontWeight = '';document.getElementById('toc_authentication').style.backgroundColor = '';document.getElementById('toc_account_model').style.fontWeight = '';document.getElementById('toc_account_model').style.backgroundColor = '';document.getElementById('toc_session-based_auth_login').style.fontWeight = '';document.getElementById('toc_session-based_auth_login').style.backgroundColor = '';document.getElementById('toc_session-based_auth_logout').style.fontWeight = '';document.getElementById('toc_session-based_auth_logout').style.backgroundColor = '';document.getElementById('toc_basic_auth_for_users').style.fontWeight = '';document.getElementById('toc_basic_auth_for_users').style.backgroundColor = '';document.getElementById('toc_basic_auth_for_devices').style.fontWeight = '';document.getElementById('toc_basic_auth_for_devices').style.backgroundColor = '';document.getElementById('toc_user_accounts').style.fontWeight = '';document.getElementById('toc_user_accounts').style.backgroundColor = '';document.getElementById('toc_create_a_user_account').style.fontWeight = '';document.getElementById('toc_create_a_user_account').style.backgroundColor = '';document.getElementById('toc_get_current_user_account').style.fontWeight = '';document.getElementById('toc_get_current_user_account').style.backgroundColor = '';document.getElementById('toc_devices').style.fontWeight = '';document.getElementById('toc_devices').style.backgroundColor = '';document.getElementById('toc_create_account-linked_devices').style.fontWeight = '';document.getElementById('toc_create_account-linked_devices').style.backgroundColor = '';document.getElementById('toc_create_anonymous_device').style.fontWeight = '';document.getElementById('toc_create_anonymous_device').style.backgroundColor = '';document.getElementById('toc_list_devices').style.fontWeight = '';document.getElementById('toc_list_devices').style.backgroundColor = '';document.getElementById('toc_get_single_device').style.fontWeight = '';document.getElementById('toc_get_single_device').style.backgroundColor = '';document.getElementById('toc_get_historical_cloud_var_data').style.fontWeight = '';document.getElementById('toc_get_historical_cloud_var_data').style.backgroundColor = '';document.getElementById('toc_update_device_properties').style.fontWeight = '';document.getElementById('toc_update_device_properties').style.backgroundColor = '';document.getElementById('toc_add/update_cloud_var_metadata').style.fontWeight = '';document.getElementById('toc_add/update_cloud_var_metadata').style.backgroundColor = '';document.getElementById('toc_update_cloud_var_value').style.fontWeight = '';document.getElementById('toc_update_cloud_var_value').style.backgroundColor = '';document.getElementById('toc_synchronization').style.fontWeight = '';document.getElementById('toc_synchronization').style.backgroundColor = '';document.getElementById('toc_track_account_resources').style.fontWeight = '';document.getElementById('toc_track_account_resources').style.backgroundColor = '';document.getElementById('toc_track_device_resources').style.fontWeight = '';document.getElementById('toc_track_device_resources').style.backgroundColor = '';document.getElementById('toc_track_historic_cloud_variable_data').style.fontWeight = '';document.getElementById('toc_track_historic_cloud_variable_data').style.backgroundColor = '';
    if (0) {
    }
    
            else if (y + 32 > get_element_scroll_y('track_historic_cloud_variable_data')) {
                document.getElementById('toc_track_historic_cloud_variable_data').style.fontWeight = "bold";
                document.getElementById('toc_track_historic_cloud_variable_data').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('track_device_resources')) {
                document.getElementById('toc_track_device_resources').style.fontWeight = "bold";
                document.getElementById('toc_track_device_resources').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('track_account_resources')) {
                document.getElementById('toc_track_account_resources').style.fontWeight = "bold";
                document.getElementById('toc_track_account_resources').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('synchronization')) {
                document.getElementById('toc_synchronization').style.fontWeight = "bold";
                document.getElementById('toc_synchronization').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('update_cloud_var_value')) {
                document.getElementById('toc_update_cloud_var_value').style.fontWeight = "bold";
                document.getElementById('toc_update_cloud_var_value').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('add/update_cloud_var_metadata')) {
                document.getElementById('toc_add/update_cloud_var_metadata').style.fontWeight = "bold";
                document.getElementById('toc_add/update_cloud_var_metadata').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('update_device_properties')) {
                document.getElementById('toc_update_device_properties').style.fontWeight = "bold";
                document.getElementById('toc_update_device_properties').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('get_historical_cloud_var_data')) {
                document.getElementById('toc_get_historical_cloud_var_data').style.fontWeight = "bold";
                document.getElementById('toc_get_historical_cloud_var_data').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('get_single_device')) {
                document.getElementById('toc_get_single_device').style.fontWeight = "bold";
                document.getElementById('toc_get_single_device').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('list_devices')) {
                document.getElementById('toc_list_devices').style.fontWeight = "bold";
                document.getElementById('toc_list_devices').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('create_anonymous_device')) {
                document.getElementById('toc_create_anonymous_device').style.fontWeight = "bold";
                document.getElementById('toc_create_anonymous_device').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('create_account-linked_devices')) {
                document.getElementById('toc_create_account-linked_devices').style.fontWeight = "bold";
                document.getElementById('toc_create_account-linked_devices').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('devices')) {
                document.getElementById('toc_devices').style.fontWeight = "bold";
                document.getElementById('toc_devices').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('get_current_user_account')) {
                document.getElementById('toc_get_current_user_account').style.fontWeight = "bold";
                document.getElementById('toc_get_current_user_account').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('create_a_user_account')) {
                document.getElementById('toc_create_a_user_account').style.fontWeight = "bold";
                document.getElementById('toc_create_a_user_account').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('user_accounts')) {
                document.getElementById('toc_user_accounts').style.fontWeight = "bold";
                document.getElementById('toc_user_accounts').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('basic_auth_for_devices')) {
                document.getElementById('toc_basic_auth_for_devices').style.fontWeight = "bold";
                document.getElementById('toc_basic_auth_for_devices').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('basic_auth_for_users')) {
                document.getElementById('toc_basic_auth_for_users').style.fontWeight = "bold";
                document.getElementById('toc_basic_auth_for_users').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('session-based_auth_logout')) {
                document.getElementById('toc_session-based_auth_logout').style.fontWeight = "bold";
                document.getElementById('toc_session-based_auth_logout').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('session-based_auth_login')) {
                document.getElementById('toc_session-based_auth_login').style.fontWeight = "bold";
                document.getElementById('toc_session-based_auth_login').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('account_model')) {
                document.getElementById('toc_account_model').style.fontWeight = "bold";
                document.getElementById('toc_account_model').style.backgroundColor = "#d0d0d0";
            }
            
            else if (y + 32 > get_element_scroll_y('authentication')) {
                document.getElementById('toc_authentication').style.fontWeight = "bold";
                document.getElementById('toc_authentication').style.backgroundColor = "#d0d0d0";
            }
            
}
window.onload = function() {
    window.addEventListener("scroll", update_scroll);
}
</script>

    <script>
    $(function() {
        //sh_highlightDocument('../../3rdparty/shjs/', '.min.js');
    });
    </script>
</head>
<!--body onload="sh_highlightDocument('../../3rdparty/shjs/', '.min.js');"-->
<body>
<div class=main-outer>
    <div class='bg-white centered'>
        <script> 
            var RELATIVE_PATH = "../../";
            RenderTopbar("devzone");
        </script>
    </div>

    <div class='bg-lightgray banner-thin centered' >
        <div class='l'>
            <span class='logo-in-text' style='color:#ffffff'>Canopy</span> REST API
        </div>
    </div>
</div>
    <div class='hammock-toc-outer'><div class='hammock-toc-title'>Canopy REST API</div><div id='toc_authentication' class='hammock-toc-chapter'><a href='#authentication'>Authentication</a></div><div id='toc_account_model' class='hammock-toc-section'><a href='#account_model'>Account Model</a></div><div id='toc_session-based_auth_login' class='hammock-toc-section'><a href='#session-based_auth_login'>Session-based AUTH Login</a></div><div id='toc_session-based_auth_logout' class='hammock-toc-section'><a href='#session-based_auth_logout'>Session-based AUTH Logout</a></div><div id='toc_basic_auth_for_users' class='hammock-toc-section'><a href='#basic_auth_for_users'>BASIC AUTH for Users</a></div><div id='toc_basic_auth_for_devices' class='hammock-toc-section'><a href='#basic_auth_for_devices'>BASIC AUTH for Devices</a></div><div id='toc_user_accounts' class='hammock-toc-chapter'><a href='#user_accounts'>User Accounts</a></div><div id='toc_create_a_user_account' class='hammock-toc-section'><a href='#create_a_user_account'>Create a User Account</a></div><div id='toc_get_current_user_account' class='hammock-toc-section'><a href='#get_current_user_account'>Get Current User Account</a></div><div id='toc_devices' class='hammock-toc-chapter'><a href='#devices'>Devices</a></div><div id='toc_create_account-linked_devices' class='hammock-toc-section'><a href='#create_account-linked_devices'>Create Account-Linked Devices</a></div><div id='toc_create_anonymous_device' class='hammock-toc-section'><a href='#create_anonymous_device'>Create Anonymous Device</a></div><div id='toc_list_devices' class='hammock-toc-section'><a href='#list_devices'>List Devices</a></div><div id='toc_get_single_device' class='hammock-toc-section'><a href='#get_single_device'>Get Single Device</a></div><div id='toc_get_historical_cloud_var_data' class='hammock-toc-section'><a href='#get_historical_cloud_var_data'>Get Historical Cloud Var Data</a></div><div id='toc_update_device_properties' class='hammock-toc-section'><a href='#update_device_properties'>Update Device Properties</a></div><div id='toc_add/update_cloud_var_metadata' class='hammock-toc-section'><a href='#add/update_cloud_var_metadata'>Add/Update Cloud Var Metadata</a></div><div id='toc_update_cloud_var_value' class='hammock-toc-section'><a href='#update_cloud_var_value'>Update Cloud Var Value</a></div><div id='toc_synchronization' class='hammock-toc-chapter'><a href='#synchronization'>Synchronization</a></div><div id='toc_track_account_resources' class='hammock-toc-section'><a href='#track_account_resources'>Track Account Resources</a></div><div id='toc_track_device_resources' class='hammock-toc-section'><a href='#track_device_resources'>Track Device Resources</a></div><div id='toc_track_historic_cloud_variable_data' class='hammock-toc-section'><a href='#track_historic_cloud_variable_data'>Track Historic Cloud Variable Data</a></div></div>
    <div class=hammock-doc-outer>


            <div class=hammock-chapter-outer>
                <a class=hammock-a-name id=authentication name=authentication></a>
                <div class=hammock-chapter-title>
                    Authentication
                </div>
                <div class=hammock-chapter-contents>
                    
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=account_model name=account_model></a>
            <div class=hammock-section-title>
                Account Model
            </div>
            <div class=hammock-section-contents>
                
        The Canopy REST API is used by both humans and IoT devices.  There are
        two types of accounts:

        <table cellspacing=0 cellpadding=0 border=0 class=hammock-tbl>
            <tr>
                <td nowrap class=hammock-tbl-header>Account Type</td>
                <td nowrap class=hammock-tbl-header>Description</td>
            </tr>
            <tr>
                <td nowrap><b>User Account</b></td>
                <td >A human.  This may be an <b>end user</b> or a
                <b>device maker</b>.</td>
            </tr>
            <tr>
                <td nowrap><b>Device Account</b></td>
                <td >An IoT device.  This account gets created
                automatically whenever a new device resource is generated on
                the server.  See <a href=#create_account-linked_devices>C<!---->r<!---->e<!---->a<!---->t<!---->e<!----> <!---->A<!---->c<!---->c<!---->o<!---->u<!---->n<!---->t<!---->-<!---->L<!---->i<!---->n<!---->k<!---->e<!---->d<!----> <!---->D<!---->e<!---->v<!---->i<!---->c<!---->e<!---->s<!----></a> and Create
                Anonymous Device.
                </td>
            </tr>
        </table>

        Every User Account has some relationship with every device resource.

        <table cellspacing=0 cellpadding=0 border=0 class=hammock-tbl>
            <tr>
                <td  class=hammock-tbl-header>User-Device Relationship</td>
                <td  class=hammock-tbl-header>Description</td>
            </tr>
            <tr>
                <td ><b>No Access</b></td>
                <td >User cannot access the device.</td>
            </tr>
            <tr>
                <td ><b>End User</b></td>
                <td >User can interact with the device as an end user.</td>
            </tr>
            <tr>
                <td ><b>Device Maker</b></td>
                <td >User can manage the device from an inventory standpoint,
                but may not directly control or monitor it without permission from the end user.</td>
            </tr>
            <tr>
                <td ><b>Device Maker + End User</b></td>
                <td >User can do everything with the device.</td>
            </tr>
        </table>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Methods of Authentication
            </div>
            <div class=hammock-subsection-contents>
                
            Two types of authentication are supported: <b>BASIC AUTH</b> and
            <b>Session-based AUTH</b>.
            <table cellspacing=0 cellpadding=0 border=0 class=hammock-tbl>
                <tr>
                    <td  class=hammock-tbl-header>Account Type</td>
                    <td  class=hammock-tbl-header>HTTP BASIC AUTH</td>
                    <td  class=hammock-tbl-header>Session-based AUTH</td>
                    <td  class=hammock-tbl-header>Username</td>
                    <td  class=hammock-tbl-header>Password</td>
                </tr>
                <tr>
                    <td ><b>User Account</b></td>
                    <td ><b>Yes</b></td>
                    <td ><b>Yes</b></td>
                    <td >Chosen by user</td>
                    <td >Chosen by user</td>
                </tr>
                <tr>
                    <td ><b>Device Account</b></td>
                    <td ><b>Yes</b></td>
                    <td >No</td>
                    <td >Device UUID</td>
                    <td >Device Secret Key</td>
                </tr>
            </table>
        
            </div>
        </div>
    
            </div>
        </div>

    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=session-based_auth_login name=session-based_auth_login></a>
            <div class=hammock-section-title>
                Session-based AUTH Login
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <div class='hammock-multicode-outer'><div class=hammock-multicode-bar><div id=mctab0 class='hammock-multicode-tab'>REST</div><div id=mctab1 class='hammock-multicode-tab'>EXAMPLE</div><div id=mctab2 class='hammock-multicode-tab'>CURL</div></div><div id=mc0 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>POST /api/login
{
    "username" : &lt;USERNAME_OR_EMAIL&gt;,
    "password" : &lt;PASSWORD&gt;
}</pre></div>
                <div id=mc1 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>POST /api/login
{
    "username" : "leela",
    "password" : "P1anetExpre55"
}</pre></div>
                <div id=mc2 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>curl -c canopy.cookies -d '{ "username" : "leela", "password" : "P1anetExpre55" }' http://sandbox.canopy.link/api/login</pre></div>
            </div><script>$("#mctab0").on('click', function() {$("#mc0").show();$("#mctab0").toggleClass('hammock-multicode-selected', 0==0);$("#mc1").hide();$("#mctab1").toggleClass('hammock-multicode-selected', 0==1);$("#mc2").hide();$("#mctab2").toggleClass('hammock-multicode-selected', 0==2);});$("#mctab0").toggleClass('hammock-multicode-selected', 1);$("#mctab1").on('click', function() {$("#mc0").hide();$("#mctab0").toggleClass('hammock-multicode-selected', 1==0);$("#mc1").show();$("#mctab1").toggleClass('hammock-multicode-selected', 1==1);$("#mc2").hide();$("#mctab2").toggleClass('hammock-multicode-selected', 1==2);});$("#mc1").hide();$("#mctab2").on('click', function() {$("#mc0").hide();$("#mctab0").toggleClass('hammock-multicode-selected', 2==0);$("#mc1").hide();$("#mctab1").toggleClass('hammock-multicode-selected', 2==1);$("#mc2").show();$("#mctab2").toggleClass('hammock-multicode-selected', 2==2);});$("#mc2").hide();</script>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            Header:
            <pre class='hammock-code'>Set-Cookie:canopy-login-session=&lt;COOKIE_VALUE&gt;</pre>
            Body:
            <div class='hammock-multicode-outer'><div class=hammock-multicode-bar><div id=mctab3 class='hammock-multicode-tab'>REST</div><div id=mctab4 class='hammock-multicode-tab'>EXAMPLE</div></div><div id=mc3 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>200 OK
{
    "result" : "ok",
    "username" : &lt;USERNAME&gt;,
    "email" : &lt;EMAIL&gt;
}</pre></div>
                <div id=mc4 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>200 OK
{
    "result" : "ok",
    "username" : "leela",
    "email" : "leela@planetexpress.com"
}</pre></div>
            </div><script>$("#mctab3").on('click', function() {$("#mc3").show();$("#mctab3").toggleClass('hammock-multicode-selected', 3==3);$("#mc4").hide();$("#mctab4").toggleClass('hammock-multicode-selected', 3==4);});$("#mctab3").toggleClass('hammock-multicode-selected', 1);$("#mctab4").on('click', function() {$("#mc3").hide();$("#mctab3").toggleClass('hammock-multicode-selected', 4==3);$("#mc4").show();$("#mctab4").toggleClass('hammock-multicode-selected', 4==4);});$("#mc4").hide();</script>
        
            </div>
        </div>
    
            </div>
        </div>

    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=session-based_auth_logout name=session-based_auth_logout></a>
            <div class=hammock-section-title>
                Session-based AUTH Logout
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code'>POST /api/logout</pre>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code sh_javascript'>{
    "result" : "ok"
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>

    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=basic_auth_for_users name=basic_auth_for_users></a>
            <div class=hammock-section-title>
                BASIC AUTH for Users
            </div>
            <div class=hammock-section-contents>
                
        <p>
            To use <b>BASIC AUTH</b>, include the Base64-encoded
            "username:password" in every request.  For example, if your
            username is "leela" and your password is "P1anetExpre55", include
            the following header with your request:
        </p>

        <pre class='hammock-code'>Authorization: Basic bGVlbGE6UDFhbmV0RXhwcmU1NQ==</pre>

        <p>
            Most HTTP libraries and tools can handle BASIC AUTH for you.  For
            example:
        </p>
        <div class='hammock-multicode-outer'><div class=hammock-multicode-bar><div id=mctab5 class='hammock-multicode-tab'>CURL</div><div id=mctab6 class='hammock-multicode-tab'>JQUERY</div><div id=mctab7 class='hammock-multicode-tab'>PYTHON</div></div><div id=mc5 class=hammock-multicode-item><pre class='hammock-code'>curl -u leela:P1anetExpre55</pre></div>
            <div id=mc6 class=hammock-multicode-item><pre class='hammock-code'>$.ajax({
    username : "leela",
    password : "P1anetExpre55",
    ...
});</pre></div>
            <div id=mc7 class=hammock-multicode-item><pre class='hammock-code'>from requests.auth import HTTPBasicAuth
requests.get(url, auth=HTTPBasicAuth('leela', 'P1anetExpre55'))</pre></div>
        </div><script>$("#mctab5").on('click', function() {$("#mc5").show();$("#mctab5").toggleClass('hammock-multicode-selected', 5==5);$("#mc6").hide();$("#mctab6").toggleClass('hammock-multicode-selected', 5==6);$("#mc7").hide();$("#mctab7").toggleClass('hammock-multicode-selected', 5==7);});$("#mctab5").toggleClass('hammock-multicode-selected', 1);$("#mctab6").on('click', function() {$("#mc5").hide();$("#mctab5").toggleClass('hammock-multicode-selected', 6==5);$("#mc6").show();$("#mctab6").toggleClass('hammock-multicode-selected', 6==6);$("#mc7").hide();$("#mctab7").toggleClass('hammock-multicode-selected', 6==7);});$("#mc6").hide();$("#mctab7").on('click', function() {$("#mc5").hide();$("#mctab5").toggleClass('hammock-multicode-selected', 7==5);$("#mc6").hide();$("#mctab6").toggleClass('hammock-multicode-selected', 7==6);$("#mc7").show();$("#mctab7").toggleClass('hammock-multicode-selected', 7==7);});$("#mc7").hide();</script>
    
            </div>
        </div>

    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=basic_auth_for_devices name=basic_auth_for_devices></a>
            <div class=hammock-section-title>
                BASIC AUTH for Devices
            </div>
            <div class=hammock-section-contents>
                
        Canopy REST API requests can be made by both human users and IoT
        devices.  When an IoT device is making the request:
        <ul><li>The device's <b>UUID</b> is the username.</li>
            <li>The device's <b>Secret Key</b> is the password.</li>
        </ul>

        For example:
        <pre class='hammock-code'>For a device with:

    - UUID: d5c827d2-1ba7-4da6-b87b-0864f0969fa8
    - Secret Key: 00ae8a3ba42fa86765c885da90a7fcaec9898acb13fc2e00

You would:

    Base64Encode("d5c827d2-1ba7-4da6-b87b-0864f0969fa8:00ae8a3ba42fa86765c885da90a7fcaec9898acb13fc2e00")

And then send this header:

    Authorization: Basic ZDVjODI3ZDItMWJhNy00ZGE2LWI4N2ItMDg2NGYwOTY5ZmE4OjAwYWU4YTNiYTQyZmE4Njc2NWM4
    ODVkYTkwYTdmY2FlYzk4OThhY2IxM2ZjMmUwMA==</pre>
    
            </div>
        </div>


                </div>
            </div>


            <div class=hammock-chapter-outer>
                <a class=hammock-a-name id=user_accounts name=user_accounts></a>
                <div class=hammock-chapter-title>
                    User Accounts
                </div>
                <div class=hammock-chapter-contents>
                    
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=create_a_user_account name=create_a_user_account></a>
            <div class=hammock-section-title>
                Create a User Account
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <div class='hammock-multicode-outer'><div class=hammock-multicode-bar><div id=mctab8 class='hammock-multicode-tab'>REST</div><div id=mctab9 class='hammock-multicode-tab'>EXAMPLE</div><div id=mctab10 class='hammock-multicode-tab'>CURL</div></div><div id=mc8 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>POST /api/create_account
{
    "username" : &lt;USERNAME&gt;,
    "email" : &lt;EMAIL&gt;,
    "password" : &lt;PASSWORD&gt;
}</pre></div>
                <div id=mc9 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>POST /api/create_account
{
    "username" : "leela",
    "email" : "leela@planetexpress.com",
    "password" : "P1anetExpre55"
}</pre></div>
                <div id=mc10 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>curl -d '{ "username" : "leela", "email": "leela@planetexpress.com", "password" : "P1anetExpre55" }' http://sandbox.canopy.link/api/create_account</pre></div>
            </div><script>$("#mctab8").on('click', function() {$("#mc8").show();$("#mctab8").toggleClass('hammock-multicode-selected', 8==8);$("#mc9").hide();$("#mctab9").toggleClass('hammock-multicode-selected', 8==9);$("#mc10").hide();$("#mctab10").toggleClass('hammock-multicode-selected', 8==10);});$("#mctab8").toggleClass('hammock-multicode-selected', 1);$("#mctab9").on('click', function() {$("#mc8").hide();$("#mctab8").toggleClass('hammock-multicode-selected', 9==8);$("#mc9").show();$("#mctab9").toggleClass('hammock-multicode-selected', 9==9);$("#mc10").hide();$("#mctab10").toggleClass('hammock-multicode-selected', 9==10);});$("#mc9").hide();$("#mctab10").on('click', function() {$("#mc8").hide();$("#mctab8").toggleClass('hammock-multicode-selected', 10==8);$("#mc9").hide();$("#mctab9").toggleClass('hammock-multicode-selected', 10==9);$("#mc10").show();$("#mctab10").toggleClass('hammock-multicode-selected', 10==10);});$("#mc10").hide();</script>
            <table cellspacing=0 cellpadding=0 border=0 class=hammock-tbl>
                <tr>
                    <td  class=hammock-tbl-header>Field</td>
                    <td  class=hammock-tbl-header>Validation</td>
                </tr>
                <tr>
                    <td ><span class=hammock-icode>"username"</span></td>
                    <td >string
                        <ul><li>5-24 characters</li>
                            <li>Characters a-z, A-Z, 0-9 and underscore(_) allowed.</li>
                            <li>Must start with a letter</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td ><span class=hammock-icode>"email"</span></td>
                    <td >string
                        <ul><li>Must be a valid email address.</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td ><span class=hammock-icode>"password"</span></td>
                    <td >string
                        <ul><li>6-120 characters</li>
                            <li>All characters allowed</li>
                        </ul>
                    </td>
                </tr>
            </table>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            <div class='hammock-multicode-outer'><div class=hammock-multicode-bar><div id=mctab11 class='hammock-multicode-tab'>REST</div><div id=mctab12 class='hammock-multicode-tab'>EXAMPLE</div></div><div id=mc11 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>200 OK
{
    "email" : &lt;EMAIL&gt;,
    "result" : "ok",
    "username" : &lt;USERNAME&gt;
}</pre></div>
                <div id=mc12 class=hammock-multicode-item><pre class='hammock-code sh_javascript'>200 OK
{
    "email" : "leela@planetexpress.com",
    "result" : "ok",
    "username" : "leela",
}</pre></div>
            </div><script>$("#mctab11").on('click', function() {$("#mc11").show();$("#mctab11").toggleClass('hammock-multicode-selected', 11==11);$("#mc12").hide();$("#mctab12").toggleClass('hammock-multicode-selected', 11==12);});$("#mctab11").toggleClass('hammock-multicode-selected', 1);$("#mctab12").on('click', function() {$("#mc11").hide();$("#mctab11").toggleClass('hammock-multicode-selected', 12==11);$("#mc12").show();$("#mctab12").toggleClass('hammock-multicode-selected', 12==12);});$("#mc12").hide();</script>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=get_current_user_account name=get_current_user_account></a>
            <div class=hammock-section-title>
                Get Current User Account
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code'>GET /api/me</pre>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code sh_javascript'>{
    "result" : "ok",
    "username" : &lt;USERNAME&gt;,
    "email" : &lt;EMAIL&gt;,
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>

                </div>
            </div>


            <div class=hammock-chapter-outer>
                <a class=hammock-a-name id=devices name=devices></a>
                <div class=hammock-chapter-title>
                    Devices
                </div>
                <div class=hammock-chapter-contents>
                    
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=create_account-linked_devices name=create_account-linked_devices></a>
            <div class=hammock-section-title>
                Create Account-Linked Devices
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            To create one or more new devices from a User Account:
            <pre class='hammock-code sh_javascript'>POST /api/create_devices
{
    "quanitity" : &lt;QUANITITY&gt;
    "friendly_names" : [&lt;FRIENDLY_NAME&gt;, ...]
}</pre>
            This will create a new device resource and associate it with the
            current User Account.  This will also automatically assign a UUID
            and Secret Key to each new device resource.
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code sh_javascript'>{
    "result" : "ok",
    "devices" : [ {
        "friendly_name" : &lt;FRIENDLY_NAME&gt;
        "device_id" : &lt;UUID&gt;
        "device_secret_key" : &lt;DEVICE_SECRET_KEY&gt;
    }, ... ]
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=create_anonymous_device name=create_anonymous_device></a>
            <div class=hammock-section-title>
                Create Anonymous Device
            </div>
            <div class=hammock-section-contents>
                
        Some deployments of the Canopy Cloud Service allow devices to be
        created that are not associated with any User account.  These are
        called "anonymous devices".

        Each anonymous device has a user-assigned Secret Key that is used to
        restrict access.

        Anonymous devices are automatically created by the
        <span class=hammock-icode>/api/sync</span> endpoint.  When <span class=hammock-icode>/api/sync</span>
        encounters a new Device UUID in the BASIC AUTH header, it will create a
        new anonymous device.
    
            </div>
        </div>

    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=list_devices name=list_devices></a>
            <div class=hammock-section-title>
                List Devices
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            To obtain a list of all devices the current Account has access to:
            <pre class='hammock-code'>GET /api/me/devices</pre>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code sh_javascript'>{
    "result" : "ok",
    "devices" : [ {
        "device_id" : &lt;UUID&gt;,
        "friendly_name" : &lt;FRIENDLY_NAME&gt;,
        "status" : {
            "oper_status" : &lt;OPER_STATUS&gt;,
            "ws_connected" : &lt;WS_CONNECTED&gt;,
            "last_seen" : &lt;LAST_SEEN&gt;,
        },
        "sddl" : { &lt;SDDL&gt; },
        "vars" : { &lt;VARS&gt; },
    }, ...  ]
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=get_single_device name=get_single_device></a>
            <div class=hammock-section-title>
                Get Single Device
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            To obtain information about a single device:
            <pre class='hammock-code'>GET /api/device/&lt;UUID&gt;</pre>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code sh_javascript'>{
    "result" : "ok",
    "device_id" : &lt;UUID&gt;,
    "friendly_name" : &lt;FRIENDLY_NAME&gt;,
    "status" : {
        "oper_status" : &lt;OPER_STATUS&gt;,
        "ws_connected" : &lt;WS_CONNECTED&gt;,
        "last_seen" : &lt;LAST_SEEN&gt;,
    },
    "sddl" : { &lt;SDDL&gt; },
    "vars" : { &lt;VARS&gt; },
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=get_historical_cloud_var_data name=get_historical_cloud_var_data></a>
            <div class=hammock-section-title>
                Get Historical Cloud Var Data
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code'>GET /api/device/&lt;UUID&gt;/&lt;VAR_PATH&gt;</pre>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=update_device_properties name=update_device_properties></a>
            <div class=hammock-section-title>
                Update Device Properties
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            To update device properties:
            <pre class='hammock-code sh_javascript'>POST /api/device/&lt;UUID&gt;
{
    "friendly_name" : &lt;NEW_FRIENDLY_NAME&gt;,
    "location_note" : &lt;NEW_LOCATION_NOTE&gt;,
}</pre>
            <p>
                All fields are optional and omitted fields will be left
                unchanged.
            </p>
            <p>
                This may be combined with <a href=#add/update_cloud_var_metadata>A<!---->d<!---->d<!---->/<!---->U<!---->p<!---->d<!---->a<!---->t<!---->e<!----> <!---->C<!---->l<!---->o<!---->u<!---->d<!----> <!---->V<!---->a<!---->r<!----> <!---->M<!---->e<!---->t<!---->a<!---->d<!---->a<!---->t<!---->a<!----></a>
                and <a href=#update_cloud_var_value>U<!---->p<!---->d<!---->a<!---->t<!---->e<!----> <!---->C<!---->l<!---->o<!---->u<!---->d<!----> <!---->V<!---->a<!---->r<!----> <!---->V<!---->a<!---->l<!---->u<!---->e<!----></a>s into a single request.
            </p>
        
            </div>
        </div>
    
            </div>
        </div>

    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=add/update_cloud_var_metadata name=add/update_cloud_var_metadata></a>
            <div class=hammock-section-title>
                Add/Update Cloud Var Metadata
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <p>
                To add a new cloud variable, or update an existing cloud
                variable's metadata, use:
            </p>
            <pre class='hammock-code sh_javascript'>POST /api/device/&lt;UUID&gt;
{
    "sddl" : {
        &lt;VAR_DECL&gt; : &lt;VAR_PROPERTIES&gt;,
        ...
    }
}</pre>
            <p>
                This may be combined with <a href=#add/update_cloud_var_metadata>A<!---->d<!---->d<!---->/<!---->U<!---->p<!---->d<!---->a<!---->t<!---->e<!----> <!---->C<!---->l<!---->o<!---->u<!---->d<!----> <!---->V<!---->a<!---->r<!----> <!---->M<!---->e<!---->t<!---->a<!---->d<!---->a<!---->t<!---->a<!----></a>
                and <a href=#update_cloud_var_value>U<!---->p<!---->d<!---->a<!---->t<!---->e<!----> <!---->C<!---->l<!---->o<!---->u<!---->d<!----> <!---->V<!---->a<!---->r<!----> <!---->V<!---->a<!---->l<!---->u<!---->e<!----></a>s into a single request.
            </p>
            <p>
                To fully replace the list of cloud variables, add
                <span class=hammock-icode>"full-replacement" : true</span> to the request.
                <pre class='hammock-code'>POST /api/device/&lt;UUID&gt;
{
    "sddl" : {
        "full-replacement" : true,
        &lt;VAR_DECL&gt; : &lt;VAR_PROPERTIES&gt;,
        ...
    }
}</pre>
            </p>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=update_cloud_var_value name=update_cloud_var_value></a>
            <div class=hammock-section-title>
                Update Cloud Var Value
            </div>
            <div class=hammock-section-contents>
                
        <p>
            To update Cloud Variable values, use:
        </p>
        <pre class='hammock-code sh_javascript'>POST /api/device/&lt;UUID&gt;
{
    "vars" : {
        &lt;VAR_NAME&gt; : &lt;NEW_VALUE&gt;,
        ...
    }
}</pre>
        <p>
            This will automatically create a cloud variable for each
            newly-encountered var, unless the device's
            <span class=hammock-icode>"auto-var-creation"</span> property is set to
            <span class=hammock-icode>false</span>.  See Automatic Cloud Variable Creation.
        </p>
        <p>
            This request may be made by either a User Account or a Device
            Account.  The Cloud Variable's <span class=hammock-icode>direction</span>
            property controls who can modify it:
        </p>
        <table cellspacing=0 cellpadding=0 border=0 class=hammock-tbl>
            <tr>
                <td  class=hammock-tbl-header>Direction</td>
                <td  class=hammock-tbl-header>Who Can Modify Value</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>in</span></td>
                <td >User Account</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>out</span></td>
                <td >Device Account</td>
            </tr>
            <tr>
                <td ><span class=hammock-icode>inout</span></td>
                <td >User or Device Account</td>
            </tr>
        </table>
    
            </div>
        </div>

                </div>
            </div>


            <div class=hammock-chapter-outer>
                <a class=hammock-a-name id=synchronization name=synchronization></a>
                <div class=hammock-chapter-title>
                    Synchronization
                </div>
                <div class=hammock-chapter-contents>
                    
    The "synchronization" mechanism allows multiple resources to be tracked and
    updated efficiently with a single API request.  Tracked resources can
    include accounts, devices, and cloud variables.  If using Session-based
    AUTH, the list of tracked resources will be remembered across requests.

    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=track_account_resources name=track_account_resources></a>
            <div class=hammock-section-title>
                Track Account Resources
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code sh_javascript'>POST api/sync
{
    ...
    "track-accounts" : [&lt;USERNAME&gt;, ...]
    ...
}</pre>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            The response will include basic information about each device that
            the tracked accounts have access to.
            <pre class='hammock-code sh_javascript'>{
    ...
    "accounts" : {
        &lt;USERNAME&gt; : {
            "devices" : [ &lt;DEVICE_UUID&gt;, ... ]
        }
    },
    "devices" : {
        &lt;DEVICE_UUID&gt; :  {
            "friendly_name" : &lt;FRIENDLY_NAME&gt;,
            "connected" : &lt;CONNECTED&gt;,
            "sddl_hash" : &lt;SDDL_HASH&gt;,
        }
    },
    "sddl" : {
        &lt;SDDL_HASH&gt; : {
            &lt;SDDL&gt;
        }
    }
    ...
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=track_device_resources name=track_device_resources></a>
            <div class=hammock-section-title>
                Track Device Resources
            </div>
            <div class=hammock-section-contents>
                
        <pre class='hammock-code'>POST api/sync
{
    ...
    "track-devices" : [&lt;DEVICE_UUID&gt;, ...]
    ...
}</pre>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            Detailed information about tracked devices, including Cloud
            Variable values, will be included in the response.
            <pre class='hammock-code'>{
    ...
    "devices" : {
        &lt;DEVICE_UUID&gt; :  {
            "friendly_name" : &lt;FRIENDLY_NAME&gt;,
            "connected" : &lt;CONNECTED&gt;,
            "sddl_hash" : &lt;SDDL_HASH&gt;,
            "vars" : &lt;VARS&gt;,
            "notifs" : &lt;NOTIFICATIONS&gt;,
        }
    },
    "sddl" : {
        &lt;SDDL_HASH&gt; : {
            &lt;SDDL&gt;
        }
    }
    ...
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>
    
        <div class=hammock-section-outer>
            <a class=hammock-a-name id=track_historic_cloud_variable_data name=track_historic_cloud_variable_data></a>
            <div class=hammock-section-title>
                Track Historic Cloud Variable Data
            </div>
            <div class=hammock-section-contents>
                
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Request
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code'>POST api/sync
{
    ...
    "track-vars" : ["UUID:gps[0].longitude", ...]
    ...
}</pre>
        
            </div>
        </div>
        
        <div class=hammock-subsection-outer>
            <div class=hammock-subsection-title>
                Response
            </div>
            <div class=hammock-subsection-contents>
                
            <pre class='hammock-code'>{
    "devices" : {
        &lt;DEVICE_UUID&gt; : {
            "vars" : {
                "gps" : [ {
                    "longitude" : {
                        "t" : RFC3339DATE,
                        "v" : CURRENT_VALUE,
                        "history" : [
                            &lt;HISTORIC_SAMPLES&lt;
                        ]
                    }
                }, ... ]
            }
        }
    }
}</pre>
        
            </div>
        </div>
    
            </div>
        </div>


                </div>
            </div>

</div>
    <script> 
        RenderFooter();
    </script>
</body>
</html>

