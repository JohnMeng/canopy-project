<!doctype html>
<html>

<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="index.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,700|ABeeZee|Titillium+Web:200,300,400,700' rel='stylesheet' type='text/css'>
    <link href='apidocs.css' rel='stylesheet' type='text/css'>
</head>

<body>
<div class=main>
    <h1>Smart Device Description Language (SDDL) Specification</h1>
    <h2><a name=toc />Document Version 5/29/2014</h2>
    <div class=text>
        <a href=#overview>Overview</a><br>
            <div class=tabbed><a href=#top_level_json_object>Top-level JSON object</a></div>
            <div class=tabbed><a href=#basic_property_types>Basic property types</a></div>
            <div class=tabbed><a href=#property_arrays_and_maps>Property arrays and maps</a></div>
            <div class=tabbed><a href=#property_names>Property names</a></div>
        <a href=#control_properties>Control properties</a><br>
            <div class=tabbed><a href=#declaring_a_control_property>Declaring a control property</a></div>
            <div class=tabbed><a href=#defining_a_control_property>Defining a control property</a></div>
        <a href=#sensor_properties>Sensor properties</a><br>
            <div class=tabbed><a href=#declaring_a_sensor_property>Declaring a sensor property</a></div>
            <div class=tabbed><a href=#defining_a_sensor_property>Defining a sensor property</a></div>
        <a href=#class_properties>Class properties</a><br>
            <div class=tabbed><a href=#declaring_a_class_property>Declaring a class property</a></div>
            <div class=tabbed><a href=#defining_a_class_property>Defining a class property</a></div>
        <a href=#arrays>Arrays</a><br>
            <div class=tabbed><a href=#declaring_an_array_of_properties>Declaring an array of properties</a></div>
        <a href=#maps>Maps</a><br>
            <div class=tabbed><a href=#declaring_a_map>Declaring a map</a></div>
    </div>

    <h2><a name=overview>Overview</a></h2>
    <p>
        The Smart Device Description Language (SDDL) is a JSON-based document
        format used to convey information about a device's sensors and controls.
    </p>

    <h3><a name=top_level_json_object>Top-level JSON object</a></h3>
    <p>
        SDDL documents are JSON-encoded.  Each SDDL document contains a single
        top-level JSON object, beginning with <code>{</code> and ending with
        <code>}</code>.  This top-level object may contain 0 or more keys.
    </p>
    <p>
        For example, here is the simplest allowable SDDL document:
    </p>
    <div class=code>{
}</div>
    <p>
        The general top-level structure for an SDDL document is:
    </p>
    <div class=code>{
    <span class=code_template>ROOT_METADATA_KEY</span> : <span class=code_template>ROOT_METADATA_VALUE</span>, 
    <span class=code_template>ROOT_METADATA_KEY</span> : <span class=code_template>ROOT_METADATA_VALUE</span>, 
    ...
    
    <span class=code_template>PROPERTY_DECLARATION</span> : <span class=code_template>PROPERTY_DEFINITION</span>,
    <span class=code_template>PROPERTY_DECLARATION</span> : <span class=code_template>PROPERTY_DEFINITION</span>,
    ...

}</div>

    <p>
        The <code>ROOT_METADATA_KEY</code> keys may be zero or more of the
        following:
    </p>
    <div class=code>"authors"

    List of strings naming the individual(s) who authored this SDDL file.

    Defaults to [] if omitted.
    
"description"

    Text describing the purpose of this SDDL file.  This field is intended
    to be used for reference only and should not be shown to end-users.

    Value must be a string.

    Defaults to "" if omitted.
    </div>

    <h3><a name=basic_property_types>Basic property types</a></h3>
    <p>
        SDDL supports three (3) basic property types:
        <code>control</code>, <code>sensor</code>, and
        <code>class</code>.
    </p>
    <p>
        A <code>control</code> represents a device setting that can be changed
        remotely.
    </p>
    <p>
        A <code>sensor</code> represents a piece of data that is known to the device,
        that changes over time, and that can be monitored remotely.
    </p>
    <p>
        A <code>class</code> is a collection of other properties (similar to a
        "struct" in other languages).
    </p>
    <h3><a name=property_arrays_and_maps>Property arrays and maps</a></h3>
    <p>
        SDDL also supports <code>array</code> and <code>map</code> property
        collections.
    </p>
    <p>
        An <code>array</code> is a fixed-length list of properties.  In an <code>array</code>, each
        entry has the same property definition.
    </p>
    <p>
        A <code>map</code> is an unordered mapping from a basic datatype (such
        as strings) to properties.  In a <code>map</code>, each value has the
        same property definition.
    </p>

    <h3><a name=property_names>Property names</a></h3>
    <p>
        A property name must contain only the characters <code>A-Z</code>,
        <code>a-z</code>, <code>0-9</code>, <code>_</code> (underscore), and
        <code>.</code> (dot).  Case is ignored, but by convention all lowercase
        is used.
    </p>

    <h4>Class naming conventions</h4>
    <p>
        To avoid namespace collisions, it is recommended that
        top-level <code>class</code> property names obey the following convention:
    </p>
    <p>
        <span class=icode>PRODUCT_NAME</span>
        <span class=icode>.</span>
        <span class=icode>OPTIONAL_SUB_NAMESPACES</span>
        <span class=icode>.</span>
        <span class=icode>PRODUCT_MODEL</span>
    </p>
    <p>That is:
    <ul>
        <li>Begin with the name of the <b>product vendor</b> then a <div class=icode>.</div> (dot).</li>
        <li>Follow with 0 or more sub-namespaces of the vendor's choosing, each ending with a <div class=icode>.</div> (dot).</li>
        <li>Finish with specific <b>product model</b>.
    </ul>

    <p>
        This example SDDL document shows the class names for two hypothetical
        products:
    </p>

    <div class=code>{
    "class miele.smart_oven_3000" : { },
    "class dyson.fans.dyson_cool.am08" : { },
}</div>
    

    <h2><a name=control_properties>Control properties</a></h2>
    <p>
        A <code>control</code> represents a device setting that can be changed
        remotely.
    </p>

    <h3><a name=declaring_a_control_property>Declaring a control property</a></h3>
    <p>
        To declare a <code>control</code> property, use:
    </p>
    <div class=code>"control <span class=code_template>CONTROL_NAME</span>" : <span class=code_template>CONTROL_DEFINITION</span> </div>
    <p>
        For example:
    </p>
    <div class=code>"control master_power_switch" : { 
    "datatype" : "bool"
}</div>

    <h3><a name=defining_a_control_property>Defining a control property</a></h3>
    <p>
        A <code>control</code> is defined using a JSON object containing 
        one or more of the following keys:
    </p>
    <div class=code>"control-type"

    Specifies the type of control, either "parameter" or "trigger".  A
    "parameter" control always has a <i>current value</i> that can be queried,
    whereas a "trigger" control does not.

    Value must be one of: "parameter" or "trigger".

    Defaults to "parameter" if omitted.

"datatype"

    Specifies the underlying datatype used for this control's values.  
    
    Value must be one of:
        "string"
        "bool"
        "int8"
        "uint8"
        "int16"
        "uint16"
        "int32"
        "uint32"
        "float32"
        "float64"
        "enum"

    Defaults to "float32" if omitted

"description"

    Describes the purpose of this control to application developers, giving
    semantic meaning to the control's definition.  This field is intended to be
    used for reference only and should not be shown to end-users.

    Value must be a string.

    Defaults to "" if omitted.

"max-value"

    Maximum numeric value that this control can have.  This field is only
    applicable if the control has one of the "int", "uint" or "float"
    datatypes, and must be omitted or set to null otherwise.  If null, the
    control's datatype will dictate the maximum allowed value.

    This field's value must be a number that is representable in the control's
    datatype, or null.

    Defaults to null if omitted.

"min-value"

    Minimum numeric value that this control can have.  This field is only
    applicable if the control has one of the "int", "uint" or "float"
    datatypes, and must be omitted or set to null otherwise.  If null, the
    control's datatype will dictate the minimum allowed value.

    This field's value must be a number that is representable in the control's
    datatype, or null.

    Defaults to null if omitted.

"numeric-display-hint"

    Provides hint to application about how to display this control's value,
    either "normal", "hex", "scientific", or "percentage".  Applications
    may choose how to interpret this hint, and may ignore it entirely.

    Defaults to "normal" if omitted.

"regex"

    Regular expression that this control's value must match.  This field is
    only applicable if the control has a "string" datatype, and must be omitted
    or set to null otherwise.  If null, no regular expression validation is
    performed.

    This field must be a string regular expression, using syntax accepted by
    RE2, or null.

    Defaults to null if omitted.

"units"

    Provide hint to application about the physical units of this control's
    value.  Must be string.

    Defaults to "" if omitted.
</div>

    <h2><a name=sensor_properties>Sensor properties</a></h2>
    <p>
        A <code>sensor</code> represents a piece of data that is known to the device,
        that changes over time, and that can be monitored remotely.
    </p>
    <h3><a name=declaring_a_sensor_property>Declaring a sensor property</a></h3>
    <p>
        To declare a <code>sensor</code> property, use:
    </p>
    <div class=code>"sensor <span class=code_template>SENSOR_NAME</span>" : <span class=code_template>SENSOR_DEFINITION</span> </div>
    <p>
        For example:
    </p>
    <div class=code>"sensor humidity" : { 
    "datatype" : "float32",
    "min-value" : 0.0,
    "max-value" : 1.0,
    "numeric-display-hint" : "percentage"
}</div>
    <h3><a name=defining_a_sensor_property>Defining a sensor property</a></h3>
    <p>
        A <code>sensor</code> is defined using a JSON object containing one or more of
        the following keys:
    </p>
    <div class=code>"datatype"

    Specifies the underlying datatype used for this sensor's values.  
    
    Value must be one of:
        "string"
        "bool"
        "int8"
        "uint8"
        "int16"
        "uint16"
        "int32"
        "uint32"
        "float32"
        "float64"
        "enum"

    Defaults to "float32" if omitted

"description"

    Describes the purpose of this sensor to application developers, giving
    semantic meaning to the sensor's definition.  This field is intended to be
    used for reference only and should not be shown to end-users.

    Value must be a string.

    Defaults to "" if omitted.

"max-value"

    Maximum numeric value that this sensor can have.  This field is only
    applicable if the sensor has one of the "int", "uint" or "float"
    datatypes, and must be omitted or set to null otherwise.  If null, the
    sensor's datatype will dictate the maximum allowed value.

    This field's value must be a number that is representable in the sensor's
    datatype, or null.

    Defaults to null if omitted.

"min-value"

    Minimum numeric value that this sensor can have.  This field is only
    applicable if the sensor has one of the "int", "uint" or "float"
    datatypes, and must be omitted or set to null otherwise.  If null, the
    sensor's datatype will dictate the minimum allowed value.

    This field's value must be a number that is representable in the sensor's
    datatype, or null.

    Defaults to null if omitted.

"numeric-display-hint"

    Provides hint to application about how to display this sensor's value,
    either "normal", "hex", "scientific", or "percentage".  Applications
    may choose how to interpret this hint, and may ignore it entirely.

    Defaults to "normal" if omitted.

"regex"

    Regular expression that this sensor's value must match.  This field is
    only applicable if the sensor has a "string" datatype, and must be omitted
    or set to null otherwise.  If null, no regular expression validation is
    performed.

    This field must be a string regular expression, using syntax accepted by
    RE2, or null.

    Defaults to null if omitted.

"units"

    Provide hint to application about the physical units of this sensor's
    value.  Must be string.

    Defaults to "" if omitted.
</div>

    <h2><a name=class_properties>Class properties</a></h2>
    <p>
        A <code>class</code> property is a collection of child properties,
        along with some additional metadata.  
    </p>
    <h3><a name=declaring_a_class_property>Declaring a class property</a></h3>
    <p>
        To declare a <code>class</code> property, use:
    </p>
    <div class=code>"class <span class=code_template>CLASS_NAME</span>" : <span class=code_template>CLASS_DEFINITION</span> </div>
    <p>
        For example:
    </p>
    <div class=code>"class canopy.example.toaster" : { 
    "control darkness" : {
        "datatype" : "int8",
        "min-value" : 0,
        "max-value" : 4,
    },
    "control bagel_mode" : {
        "datatype" : "bool",
    },
    "sensor time_remaining" : {
        "datatype" : "float32",
        "min-value" : 0,
    }

}</div>
    <h3><a name=defining_a_class_property>Defining a class property</a></h3>
    <p>
    A <code>class</code> is defined using a
    JSON object:
    <div class=code>"class <span class=code_template>CLASS_NAME</span>" : {
    <span class=code_template>CLASS_METADATA_KEY</span> : <span class=code_template>CLASS_METADATA_VALUE</span>, 
    <span class=code_template>CLASS_METADATA_KEY</span> : <span class=code_template>CLASS_METADATA_VALUE</span>, 
    ...
    
    <span class=code_template>PROPERTY_DECLARATION</span> : <span class=code_template>PROPERTY_DEFINITION</span>,
    <span class=code_template>PROPERTY_DECLARATION</span> : <span class=code_template>PROPERTY_DEFINITION</span>,
    ...

}</div>
    <p>
        The <code>CLASS_METADATA_KEY</code> keys may be zero or more of the
        following:
    </p>
    <div class=code>"authors"

    List of strings naming the individual(s) who authored this class.

    Defaults to [] if omitted.
    
"description"

    Describes the purpose of this class to application developers, giving
    semantic meaning to the class's definition.  This field is intended to be
    used for reference only and should not be shown to end-users.

    Value must be a string.

    Defaults to "" if omitted.
    </div>

    <p>
        The <code>PROPERTY_DECLARATION</code> keys declare the member
        <code>control</code>, <code>sensor</code>, <code>class</code>,
        <code>array</code>, and <code>map</code> properties.  See <a
        href=#property_declarations>Property declarations</a>.
    </p>
    <p>
        The <code>PROPERTY_DEFINITION</code> values define the corresponding
        <code>control</code>, <code>sensor</code>, <code>class</code>,
        <code>array</code>, and <code>map</code> properties.
    </p>
    <p>
        Classes may be nested arbitrarily deep.  For example, this is a valid
        <code>class</code>:
    </p>
    <div class=code>"class outer" : {
    "description" : "Example showing nesting of classes",
    "class middle" : {
        "class inner" : {
            "class innermost" : {
                "description" : "I'm the inner-most class!"
            }
        }
    }
}
    </div>

    <h2><a name=arrays>Arrays</a></h2>
    <p>
        An <code>array</code> is a fixed-length list of properties.  In an <code>array</code>, each
        entry has the same property definition.
    </p>
    <h3><a name=declaring_an_array_of_properties>Declaring an array of properties</a></h3>
    <p>
        An <code>array</code> can be created from any of the three basic
        property types (<code>control</code>, <code>sensor</code>, or
        <code>class</code>) by using square brackets <code>[]</code> with a non-negative
        integer size:
    </p>
    <div class=code>"<span class=code_template>PROPERTY_TYPE</span> <span class=code_template>PROPERTY_NAME</span>[<span class=code_template>NUM_ITEMS</span>]" : <span class=code_template>PROPERTY_DEFINITION</span> </div>
    <p>
        For example, to create an array of 4 sensors:
    </p>
    <div class=code>"sensor outlet_wattage[4]" : {
    "datatype" : "float32",
    "units" : "watts"
}</div>

    <h2><a name=maps>Maps</a></h2>
    <p>
        A <code>map</code> is an unordered mapping from a basic datatype (such
        as strings) to properties.  In a <code>map</code>, each value has the
        same property definition.
    </p>
    <h3><a name=declaring_a_map>Declaring a map</a></h3>
    <p>
        A <code>map</code> can be created by using curly braces
        <code>{}</code> with the keys' datatype inside:
    </p>
    <div class=code>"<span class=code_template>PROPERTY_TYPE</span> <span class=code_template>PROPERTY_NAME</span>{<span class=code_template>KEY_DATATYPE</span>}" : <span class=code_template>PROPERTY_DEFINITION</span> </div>
    <p>
        For example, a "smart scale" may use a <code>map</code> to report the weight of several individuals, identified by their name:
    </p>
    <div class=code>"sensor weight{string}" : {
    "datatype" : "float32",
    "min-value" : 0.0,
    "units" : "lbs"
}</div>
    <p>
        The <code>KEY_DATATYPE</code> must be one of the following:
    </p>
    <div class=code>string
int8
uint8
int16
uint16
int32
uint32
</div>

    <br>
    <p>
        <center>
        The content of this page is licensed under the Creative Commons Attribution 3.0 License, and code is licensed under a BSD license.
    </p>

    <br>
    <br>
</div>
</body>
</html>

<!--
TODO:
- Permissions
- Errors
- Events


{
    "dyson.fans.dyson_cool.am08" : {
        "@type" : "class",
        "gps" : {
            "@extends" : "canopy.common.gps",
            "@priority" : 1,
        },
        "second_gps" : "canopy.common.gps",
    }
}

{
    "interface canopy.example.smart_fan" : {
        "control speed" : {
            "datatype" : "int8",
            "min-value" : "0",
            "max-value" : "3",
            "description" : "Fan speed.  0=off, 3=max."
        },
        "description" : "Smart fan for demo",
    }
}

{
    "interface canopy.example.tutorial1" : {
        "sensor cpu[4]" : {
            "datatype" : "float32",
            "min-value" : 0.0,
            "max-value" : 1.0,
            "description" : "CPU usage percentage, one entry for each core.",
            "units" : "percentage",
        }
        "control reboot{string}" : {
            "control-type" : "trigger",
            "datatype" : "bool",
            "description" : "Reboots the device",
        }
    }
}

{
    "canopy.example.tutorial1.computer" : {
        "@type" : "class",
        "stats[2]" : {
            "cpu[4]" : {
                "@type" : "sensor",
                "@datatype" : "float32",
                "@min-value" : 0.0,
                "@max-value" : 1.0,
                "@description" : "CPU usage percentage, one entry for each core.",
                "@units" : "percentage",
            },
            "mem" : {
                "@type" : "sensor",
                "@datatype" : "float32",
                "@min-value" : 0.0,
                "@max-value" : 1.0,
                "@description" : "CPU usage percentage, one entry for each core.",
            }
        }
        "reboot" : {
            "@type" : "control",
            "@control-type" : "trigger",
            "@datatype" : "bool",
            "@description" : "Reboots the device",
        },
    }
}
-->
