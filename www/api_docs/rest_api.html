<!doctype html>
<html>

<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="index.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,700|ABeeZee|Titillium+Web:200,300,400,700' rel='stylesheet' type='text/css'>
    <link href='apidocs.css' rel='stylesheet' type='text/css'>
</head>

<body>
<div class=main>
    <h1>Canopy REST API Documentation</h1>
    <h2><a name=toc />Document Version 5/28/2014</h2>
    <div class=text>
        <a href=#intro>Introduction</a><br>
        <a href=#api_overview>API overview</a><br>
            <div class=tabbed><a href=#resource_types>Resource types</a></div>
            <div class=tabbed><a href=#endpoint_summary>Endpoint summary</a></div>
        <a href=#permission_model>Permission model</a><br>
        <div class=tabbed><a href=#device_access_permissions>Device access permissions</a></div>
        <div class=tabbed><a href=#device_sharing_permissions>Device sharing permissions</a></div>
        <div class=tabbed><a href=#gaining_access>Gaining access</a></div>
        <a href=#error_handling>Error handling</a><br>
        <div class=tabbed><a href=#not_found_error_response>"Not found" error response</a></div>
        <div class=tabbed><a href=#bad_method_error_response>"Bad method" error response</a></div>
        <div class=tabbed><a href=#not_logged_in_error_response>"Not logged in" error response</a></div>
        <div class=tabbed><a href=#insufficient_access_privileges_error_response>"Insufficient access privileges" error response</a></div>
        <div class=tabbed><a href=#insufficient_sharing_privileges_error_response>"Internal server error" error response</a></div>
        <div class=tabbed><a href=#json_parsing_error_response>"JSON parsing" error response</a></div>
        <div class=tabbed><a href=#required_field_missing_error_response>"Required field missing" error response</a></div>
        <div class=tabbed><a href=#validation_error_response>"Validation" error response</a></div>
        <a href=#accounts>Accounts</a><br>
        <div class=tabbed><a href=#account_creation>Account creation</a></div>
        <div class=tabbed><a href=#account_login>Account login</a></div>
        <div class=tabbed><a href=#account_logout>Account logout</a></div>
        <div class=tabbed><a href=#me_account_details>"Me" Account details</a></div>
        <a href=#devices>Devices</a><br>
        <div class=tabbed><a href=#sddl>Smart Device Description Language</a></div>
        <div class=tabbed><a href=#validation_of_sddl_properties>Validation of SDDL properties</a></div>
        <div class=tabbed><a href=#device_creation>Device creation</a></div>
        <div class=tabbed><a href=#device_provisioning>Device provisioning</a></div>
        <div class=tabbed><a href=#device_details>Device details</a></div>
        <div class=tabbed><a href=#controlling_a_device>Controlling a Device</a></div>
        <div class=tabbed><a href=#fetching_historical_data>Fetching historical sensor or control data</a></div>
        <a href=#aliases>Device aliases</a><br>
        <div class=tabbed><a href=#creating_a_device_alias>Creating a Device Alias</a></div>
        <div class=tabbed><a href=#deleting_a_device_alias>Deleting a Device Alias</a></div>
        <a href=#aliases>Device permissions and sharing</a><br>
        <div class=tabbed><a href=#sharing_a_device>Sharing a Device</a></div>
        <div class=tabbed><a href=#revoking_access_to_a_device>Revoking access to a Device</a></div>
        <div class=tabbed><a href=#seeing_who_can_access_a_device>Seeing who can access a Device</a></div>
    </div>

    <h2><a name=intro>Introduction</a></h2>
    <p>
        This document contains the specification for the Canopy REST API.
    </p>
    <p>
        The Canopy REST API allows application developers to easily access, monitor,
        and control Canopy-enabled devices from the Internet, using HTTP endpoints.
    </p>
    <p>
        The Canopy Cloud Service project contains an open source implementation of this REST API.  The <a href=http://github.com/canopy-project/canopy-cloud>source</a> is available on github.
    </p>

    <h2><a name=api_overview>API overview</a></h2>
    <h3><a name=resource_types>Resource types</a></h3>
    <p>
        This API provides access to the following resources:
    <p>
    <h4>Account</h4>
    <p>
        An Account represents an end-user.  That is, someone with
    credentials to login to the Canopy Cloud Service.
    <p>

    <h4>Device</h4>
    <p>
        A Device represents a Canopy-enabled object, such as a smart
        air conditioning unit.  The Device resouce makes it simple to monitor
        and control Canopy-enabled objects.
    <p>

    <h4>Device Alias</h4>
    <p>
        A Device Alias represents a short, semi-custom URL for
        accessing a Device resource.
    <p>
    <!--h4>Event</h4>
    <p>
        An Event represents the log of an action taken by a user, or
        any other relevant event that has occurred.  Examples include account
        login, device connection &amp; disconnection, and remote control
        changes.
    <p-->

    <h3><a name=endpoint_summary>Endpoint Summary</a></h3>
    <p>
        This API provides the following HTTP endpoints:
    </p>

    <h4>Account endpoints</h4>
    <p>
        <table class=paramtable>
            <tr>
                <th>Method and URL</th>
                <th>Description</th>
                <th>Details</th>
            </tr>
            <tr>
                <td>POST /create_account</td>
                <td>Create an Account</td>
                <td>See <a href=#account_creation>Account creation</a></td>
            </tr>
            <tr>
                <td>POST /login</td>
                <td>Sign-in an Account</td>
                <td>See <a href=#account_login>Account login</a></td>
            </tr>
            <tr>
                <td>POST /logout</td>
                <td>Logout the currently signed-in Account</td>
                <td>See <a href=#account_login>Account logout</a></td>
            </tr>
            <tr>
                <td>GET /me</td>
                <td>Get details about the currently signed-in Account</td>
                <td>See <a href=#me_account_details>"Me" Account details</a></td>
            </tr>
        </table>
    </p>
    <h4>Device endpoints</h4>
    <p>
        <table class=paramtable>
            <tr>
                <th>Method and URL</th>
                <th>Description</th>
                <th>Details</th>
            </tr>
            <tr>
                <td>GET /device/&lt;DEVICE_ID&gt;
                </td>
                <td>Obtain details about a particular Canopy-enabled device.</td>
                <td>See <a href=#device_details>Device details</a></td>
            </tr>
            <tr>
                <td>POST /device/&lt;DEVICE_ID&gt;
                </td>
                <td>Remotely control a Canopy-enabled device.
                </td>
                <td>See <a href=#controlling_a_device>Controlling a Device</a></td>
            </tr>
            <tr>
                <td>GET /device/&lt;DEVICE_ID&gt;/&lt;PROPERTY_NAME&gt;
                </td>
                <td>Obtain historic sensor or control data.</td>
                <td>See <a href=#fetching_historical_data>Fetching historical sensor or control data</a></td>
            </tr>
        </table>
    </p>
    <p>
        Device Aliases provide an alternative URL scheme for accessing Device resources:
    </p>
    <p>
        <table class=paramtable>
            <tr>
                <th>Method and URL</th>
                <th>Description</th>
                <th>Details</th>
            </tr>
            <tr>
                <td>GET /&lt;ACCOUNT_USERNAME&gt;/&lt;DEVICE_ALIAS_NAME&gt;
                </td>
                <td>Obtain details about a particular Canopy-enabled device.</td>
                <td>See <a href=#device_details>Device details</a></td>
            </tr>
            <tr>
                <td>POST /&lt;ACCOUNT_USERNAME&gt;/&lt;DEVICE_ALIAS_NAME&gt;
                </td>
                <td>Remotely control a Canopy-enabled device.
                </td>
                <td>See <a href=#controlling_a_device>Controlling a Device</a></td>
            </tr>
            <tr>
                <td>
                    GET /&lt;ACCOUNT_USERNAME&gt;/&lt;DEVICE_ALIAS_NAME&gt;/&lt;PROPERTY_NAME&gt;
                </td>
                <td>Obtain historic sensor or control data.
                </td>
                <td>See <a href=#fetching_historical_data>Fetching historical sensor or control data</a></td>
            </tr>
        </table>
    </p>
    <p>
    The <code>/my</code> prefix is shorthand for the currently signed-in
    account username, and simplifies the device URLs even further:
    </p>
    <p>
        <table class=paramtable>
            <tr>
                <th>Method and URL</th>
                <th>Description</th>
                <th>Details</th>
            </tr>
            <tr>
                <td>GET /my/&lt;DEVICE_ALIAS_NAME&gt;
                </td>
                <td>Obtain details about a particular Canopy-enabled device.</td>
                <td>See <a href=#device_details>Device details</a></td>
            </tr>
            <tr>
                <td>POST /my/&lt;DEVICE_ALIAS_NAME&gt;
                </td>
                <td>Remotely control a Canopy-enabled device.
                </td>
                <td>See <a href=#controlling_a_device>Controlling a Device</a></td>
            </tr>
            <tr>
                <td>
                    GET /my/&lt;DEVICE_ALIAS_NAME&gt;/&lt;PROPERTY_NAME&gt;
                </td>
                <td>Obtain historic sensor or control data.
                </td>
                <td>See <a href=#fetching_historical_data>Fetching historical sensor or control data</a></td>
            </tr>
        </table>
    </p>
    <h4>Device Alias endpoints</h4>
    <p>
        <table class=paramtable>
            <tr>
                <th>Method and URL</th>
                <th>Description</th>
                <th>Details</th>
            </tr>
            <tr>
                <td>
                    POST /&lt;ACCOUNT_USERNAME&gt;/__aliases
                    <br>POST /my/__aliases
                </td>
                <td>
                    Create Device Alias
                </td>
                <td>See <a href=#creating_a_device_alias>Creating a Device Alias</a></td>
            </tr>
            <tr>
                <td>
                    DELETE /&lt;ACCOUNT_USERNAME&gt;/__aliases/&lt;DEVICE_ALIAS_NAME&gt;
                    <br>DELETE /my/__aliases/&lt;DEVICE_ALIAS_NAME&gt;
                </td>
                <td>
                    Remove Device Alias
                </td>
                <td>See <a href=#deleting_a_device_alias>Deleting a Device Alias</a></td>
            </tr>
        </table>
    </p>
    <h4>Device Permission endpoints</h4>
    <p>
        <table class=paramtable>
            <tr>
                <th>Method and URL</th>
                <th>Description</th>
                <th>Details</th>
            </tr>
            <tr>
                <td>
                    POST /permissions
                </td>
                <td>
                    Grant or revoke access and/or sharing privileges for
                    Devices.
                </td>
                <td>See <a href=#sharing_a_device>Sharing a Device</a></td>
            </tr>
            <tr>
                <td>
                    GET /devices/&lt;DEVICE_ID&gt;/__permissions
                    <br>GET /&lt;ACCOUNT_USERNAME&gt;/&lt;DEVICE_ALIAS_NAME&gt;/__permissions
                    <br>GET /my/&lt;DEVICE_ALIAS_NAME&gt;/__permissions
                </td>
                <td>
                    See who can access a Device.
                </td>
                <td>See <a href=#seeing_who_can_access_a_device>Seeing who can access a Device</a></td>
            </tr>
        </table>
    </p>

    <h2><a name=permission_model>Permission Model</a></h2>

    <p>
        Canopy Cloud Service is a multi-tenant system, meaning that a single
        deployment can support a large number of users controlling a large
        number of devices (in aggregate).  The permission model ensures that users can only
        monitor and control the devices that they have been given access to.
    </p>
    <h3><a name=device_access_permissions>Device access permissions</a></h3>
    <p>
        Each Account has one of the following levels of access to each Device:
    </p>
    <p>
        <table class=paramtable>
            <tr>
                <th>Device access level</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>A0 - NO_ACCESS</td>
                <td>(Default) Account is forbidden from accessing the Device</td>
            </tr>
            <tr>
                <td>A1 - MONITOR_ONLY</td>
                <td>Account can monitor the Device, but not control it</td>
            </tr>
            <tr>
                <td>A2 - MONITOR_AND_CONTROL</td>
                <td>Account can both monitor and control the Device</td>
            </tr>
        </table>
    </p>

    <h3><a name=device_sharing_permissions>Device sharing permissions</a></h3>
    <p>
    Additionally, each Account in the system may (or may not) be allowed to share a Device with others:
    </p>
    <p>
        <table class=paramtable>
            <tr>
                <th>Device sharing permission level</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>S0 - NO_SHARING</td>
                <td>(Default) Account is forbidden from granting or revoking access to this Device</td>
            </tr>
            <tr>
                <td>S1 - SHARE_ONLY</td>
                <td>Account can grant access to this Device, but not revoke
                access.  The level of access that the Account is allowed to
                grant may not exceed the Account's own level of access for the
                particular Device.</td>
            </tr>
            <tr>
                <td>S2 - SHARE_AND_REVOKE</td>
                <td>Account can both grant and revoke access to this Device.
                The level of access that the Account is allowed to grant, or
                revoke, may not exceed the Account's own level of access for
                the particular Device.
            </tr>
        </table>
    </p>

    <h3><a name=gaining_access>Gaining access</a></h3>
    <p>
        There are two ways in which an Account can gain access to a Device:
    </p>
    <h4>Gaining access from provisioning</h4>
    <p>
        For a newly purchased Canopy-enabled device, the provisioning process
        grants <code>A2+S2</code> access to the Account of the user performing
        the provisioning.  See <a href='device_provisioning'>Device provisioning</a>
    </p>
    <h4>Gaining access from sharing</h4>
    <p>
        An Account with <code>S1</code> or higher sharing permission level may
        grant other Accounts access to monitor, control, and/or further share a
        Device.  See <a href='sharing_a_device'>Sharing a Device</a>
    </p>
    
    <h2><a name=error_handling>Error handling</a></h2>
    <p>
    If an error occurs while processing a request, the appropriate HTTP status
    code is returned, unless otherwise noted.  Additionally, the response
    payload may contain additional information about the error that occurred.
    </p>
    <p>
    The general form for a successful response, unless otherwise noted, is:
    </p>
    <div class=code>200 OK
{
    "result" : "ok",
    ...
}</div>

    <p>
        The general form for an error response, unless otherwise noted, is:
    </p>
    <div class=code>4XX
{
    "result" : "error",
    "error_type" : &lt;ERROR_TYPE&gt;
    ...
}</div>

    <h3><a name=not_found_error_response>"Not found" error response</a></h3>
    <p>
        If the requested URL is not found or inaccessible, the following
        response is given:
    </p>
    
    <div class=code>404 NOT FOUND
{
    "result" : "error",
    "error_type" : "url_not_found"
}</div>

    <p>
        This response is sent if any of the following occur:
        <ul>
            <li>The requested URL is invalid.</li>
            <li>The requested URL refers to a Device, Account, Alias, or other
            resource that does not exist.</li>
            <li>The requested URL refers to a Device, Account, Alias, or other
            resource that you do not have any access to.</li>
        </ul>
    </p>

    <h3><a name=bad_method_error_response>"Bad method" error response</a></h3>
    <p>
        If the requested URL is valid, but an unsupported HTTP method is used,
        the following response is given:
    </p>
    
    <div class=code>405 METHOD NOT ALLOWED
{
    "result" : "error",
    "error_type" : "method_not_allowed"
}</div>

    <h3><a name=not_logged_in_error_response>"Not logged in" error response</a></h3>
    <p>
        If the user is not signed-in, and needs to be in order to access the
        requested resource, the following response is given:
    </p>
    <div class=code>401 UNAUTHORIZED
{
    "result" : "error",
    "error_type" : "not_logged_in"
}</div>

    <h3><a name=insufficient_access_privileges_error_response>"Insufficient access privileges" error response</a></h3>
    <p>
        If the currently signed-in user does not have sufficient access
        privileges to monitor or control a Device, the following response is
        given:
    </p>
    <div class=code>401 UNAUTHORIZED
{
    "result" : "error",
    "error_type" : "insufficient_access_privileges"
}</div>

    <h3><a name=insufficient_sharing_privileges_error_response>"Insufficient sharing privileges" error response</a></h3>
    <p>
        If the currently signed-in user does not have sufficient sharing
        privileges to share a device, the following response is
        given:
    </p>
    <div class=code>401 UNAUTHORIZED
{
    "result" : "error",
    "error_type" : "insufficient_sharing_privileges"
}</div>

    <h3><a name=internal_server_error_error_response>"Internal server error" error response</a></h3>
    <p>
        If an internal server error occurs while processing the request, and
        the Canopy Cloud Service is configured in debug mode, the response may
        contain diagnostic information:
    </p>
    <div class=code>500 Internal Server Error
{
    "result" : "error",
    "error_type" : "server_side_exception",
    "error_msg" : &lt;ERROR_MSG&gt;,
    "error_callstack" : [
        &lt;CALLSTACK_ENTRY_0&gt;,
        &lt;CALLSTACK_ENTRY_1&gt;,
        ...
    ]
}</div>
    <p>
        The <code>&lt;ERROR_MSG&gt;</code> is an implementation-specific debug
        message provided by the server describing the reason for failure.
    </p>
    <p>
        The <code>&lt;CALLSTACK_ENTRY_<i>N</i>&gt;</code> items are
        implementation-specific strings corresponding to the callstack on the
        server, if available.
    </p>

    <h3><a name=json_parsing_error_response>"JSON parsing" error response</a></h3>
    <p>
        If the request payload does not contain valid JSON, the following
        response is given:
    </p>
    <div class=code>400 BAD REQUEST
{
    "result" : "error",
    "error_type" : "invalid_json",
    "error_msg" : &lt;ERROR_MSG&gt;
}</div>
    <p>
        The <code>&lt;ERROR_MSG&gt;</code> is an implementation-specific debug
        message provided by the server describing the JSON parsing error in
        more detail.
    </p>

    <h3><a name=required_field_missing_error_response>"Required field missing" error response</a></h3>
    <p>
        If the request payload is missing a required field, the following
        response is given:
    </p>
    <div class=code>400 BAD REQUEST
{
    "result" : "error",
    "error_type" : "required_field_missing",
    "error_fields" : [&lt;MISSING_FIELD_0&gt;, &lt;MISSING_FIELD_1&gt;, ...]
}</div>
    <p>
        The <code>&lt;MISSING_FIELD_<i>N</i>&gt;</code> items are the string
        keys that were required but missing in the request.
    </p>

    <h3><a name=validation_error_response>"Validation" error response</a></h3>
    <p>
        If the request contains JSON keys or values that do not satisfy the
        input validation criteria specified in this document, the response
        will describe which fields failed validation:
        
    </p>
    <div class=code>400 BAD REQUEST
{
    "result" : "error",
    "error_type" : "input_validation_failed",
    "error_fields" : [&lt;INPUT_FIELD_0&gt;, &lt;INPUT_FIELD_1&gt;, ...]
}</div>

    <h2><a name=accounts>Accounts</a></h2>
    <p>
        An Account represents an end-user.
    </p>
    <h3><a name=account_creation>Account Creation</a></h3>
    <h4>Request (Account Creation)</h4>
    <p>
        To create a new account, use:
    </p>
    <div class=code>POST /create_account
{
    "username" : &lt;USERNAME&gt;
    "email" : &lt;EMAIL&gt;
    "password" : &lt;PASSWORD&gt;
    "password_confirm" : &lt;PASSWORD_CONFIRM&gt;
}</div>
    <p>
        <table class=paramtable>
            <tr>
                <th>Parameter</th>
                <th>Required</th>
                <th>Validation</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>&lt;USERNAME&gt;</td>
                <td>Required</td>
                <td>String.<br>^[0-9A-Za-z_-]{3,16}$</td>
                <td>New account username.  Case insensitive, but case <i>is</i> remembered.  The account username is immutable: once an account is created the unsername may not be changed.</td>
            </tr>
            <tr>
                <td>&lt;EMAIL&gt;</td>
                <td>Required</td>
                <td>String.<br>^([a-zA-Z0-9_\.-]+)@([a-zA-Z0-9_\.-]+)\.([a-zA-Z\.]+)$</td>
                <td>New account email address.  Case insensitive, but case <i>is</i> remembered.</td>
            </tr>
            <tr>
                <td>&lt;PASSWORD&gt;</td>
                <td>Required</td>
                <td>String.<br>^([a-zA-Z0-9@*#]{7,16})$</td>
                <td>New account password.</td>
            </tr>
            <tr>
                <td>&lt;PASSWORD_CONFIRM&gt;</td>
                <td>Required</td>
                <td>String.<br>Must match &lt;PASSWORD&gt; exactly.</td>
                <td>The account password again, for confirmation.</td>
            </tr>
        </table>
    </p>
    <h4>Response (Account Creation)</h4>
    <p>
        On success, a new Account is created:
    </p>
    <div class=code>200 OK
{
    "result" : "ok"
}</div>
    <p>
        On validation error: See <a href=.>Validation error response</a>
    </p>
    <p>
        If username is already taken:
    </p>
    <div class=code>403 FORBIDDEN
{
    "result" : "error",
    "error_type" : "username_unavailable"
}</div>
    <p>
        If email address is already taken:
    </p>
    <div class=code>403 FORBIDDEN
{
    "result" : "error",
    "error_type" : "email_unavailable"
}</div>


    <h3><a name=account_login>Account login</a></h3>
    <h4>Request (Account Login)</h4>
    <p>
        To login an account:
    </p>
    <div class=code>POST /login
{
    "username_or_email" : &lt;USERNAME_OR_EMAIL&gt;
    "password" : &lt;PASSWORD&gt;
}</div>
    <p>
        <table class=paramtable>
            <tr>
                <th>Parameter</th>
                <th>Required</th>
                <th>Validation</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>&lt;USERNAME_OR_EMAIL&gt;</td>
                <td>Required</td>
                <td>String.</td>
                <td>Username or email address of account to login</td>
            </tr>
            <tr>
                <td>&lt;PASSWORD&gt;</td>
                <td>Required</td>
                <td>String.</td>
                <td>Password of account to login</td>
            </tr>
        </table>
    </p>
    <h4>Response (Account Login)</h4>
    <p>
        On successful login, a server-side session is created and a cookie identifying the session is sent in the response.
    </p>
    <div class=code>200 OK
Set-Cookie:canopy-login-session=&lt;COOKIE_ENCRYPTED_VALUE&gt;; Path=/; Expires=&lt;COOKIE_EXPIRATION&gt; Max-Age=2592000
{
    "result" : "ok"
}</div>
    <p>
        If username or email is not found, or password doesn't match:
    </p>
    <div class=code>403 FORBIDDEN
{
    "result" : "error",
    "error_type" : "incorrect_username_or_password"
}</div>
    <p>
        If too many attempts have been made in a row:
    </p>
    <div class=code>403 FORBIDDEN
{
    "result" : "error",
    "error_type" : "too_many_login_attempts"
}</div>



    <h3><a name=account_logout>Account logout</a></h3>
    <h4>Request (Account Logout)</h4>
    <p>
        To logout the currently logged in user:
    </p>
    <div class=code>POST /logout</div>
    <h4>Response (Account Login)</h4>
    <p>
        On successful logout, the active server-side session is destroyed, and the session cookie is invalidated.
    </p>
    <div class=code>200 OK
{
    "result" : "ok"
}</div>
    <p>
        This same response is given even if no user was signed-in.
    </p>


    <h3><a name=me_account_details>"Me" Account Details</a></h3>
    <p>
        The <code>/me</code> endpoint refers to the currently signed-in account.
    </p>

    <h4>Request ("Me" Account Details)</h4>
    <p>
        To get information about the currently signed-in acocunt.
    </p>
    <div class=code>GET /me</div>

    <h4>Response ("Me" Account Details)</h4>
    <p>
        On success:
    </p>
    <div class=code>200 OK
{
    "result" : "ok",
    "username" : &lt;USERNAME&gt;,
    "email" : &lt;EMAIL&gt;,
}</div>
    <p>
        If no account is signed-in: See <a href=#not_logged_in_error_response>"Not logged in" error response</a>.
    </p>

    <h2><a name=devices>Devices</a></h2>
    <p>
        A Device represents a smart object that you can monitor and control.
    </p>

    <h3><a name=sddl>Smart Device Description Language (SDDL)</a></h3>
    <p>
        Each Canopy-enabled device publishes its capabilities to the Canopy
        Cloud Service using a format called the Smart Device Description
        Language ("SDDL").  The SDDL describes the device's controls and
        sensors.  The Canopy Cloud Service uses this information to generate a
        REST API specific to each Canopy-enabled device.
    </p>

    <h3><a name=validation_of_sddl_properties>Validation of SDDL properties</a></h3>
    <p>
        SDDL supports several datatypes.  The following table describes how
        SDDL property values are validated when supplied to this API using
        JSON.
    </p>
    <p>
        <table class=paramtable>
            <tr>
                <th>SDDL datatype</th>
                <th>JSON type</th>
                <th>Additional validation criteria</th>
                <th>Other notes</th>
            </tr>
            <tr>
                <td>bool</td>
                <td>true | false</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>int8</td>
                <td>number</td>
                <td>
                    Must be between -128 and 127 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>uint8</td>
                <td>number</td>
                <td>
                    Must be between 0 and 255 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>int16</td>
                <td>number</td>
                <td>
                    Must be between -32768 and 32767 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>uint16</td>
                <td>number</td>
                <td>
                    Must be between 0 and 65535 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>int32</td>
                <td>number</td>
                <td>
                    Must be between -(2<sup>31</sup>) and 2<sup>31</sup> - 1 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>uint32</td>
                <td>number</td>
                <td>
                    Must be between 0 and 2<sup>32</sup> - 1 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>int64</td>
                <td>number</td>
                <td>
                    Must be between -(2<sup>63</sup> and 2<sup>63</sup> - 1 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>uint64</td>
                <td>number</td>
                <td>
                    Must be between 0 and 2<sup>64</sup> - 1 (inclusive)
                    <br>Must not have a fractional component.
                </td>
                <td></td>
            </tr>
            <tr>
                <td>float32</td>
                <td>number</td>
                <td>
                </td>
                <td>
                    The number will be converted to a 32-bit float in an
                    implementation-dependant manner.
                </td>
            </tr>
            <tr>
                <td>float64</td>
                <td>number</td>
                <td>
                </td>
                <td>
                    The number will be converted to a 64-bit float in an
                    implementation-dependant manner.
                </td>
            </tr>
            <tr>
                <td>string</td>
                <td>string</td>
                <td>
                </td>
                <td>
                    UTF-8 encoded.
                </td>
            </tr>
        </table>
    </p>

    <p>
        The SDDL may also contain additional validation requirements for each
        control property.  The following table describes how these validation
        requirements are enforced:
    </p>
    <p>
        <table class=paramtable>
            <tr>
                <th>SDDL validation requirement</th>
                <th>JSON validation criteria</th>
            </tr>
            <tr>
                <td>min-value</th>
                <td>The supplied JSON value must be greater-than-or-equal-to the SDDL-specified "min-value".</th>
            </tr>
            <tr>
                <td>min-value-exclusive</th>
                <td>The supplied JSON value must be greater-than the SDDL-specified "min-value".</th>
            </tr>
            <tr>
                <td>max-value</th>
                <td>The supplied JSON value must be less-than-or-equal-to the SDDL-specified "max-value-exclusive".</th>
            </tr>
            <tr>
                <td>max-value-exclusive</th>
                <td>The supplied JSON value must be less-than the SDDL-specified "min-value-exclusive".</th>
            </tr>
        </table>
    </p>

    <h3><a name=device_creation>Device Creation</a></h3>
    <p>
        A Device resource is automatically created the first time a device
        connects to the Canopy Cloud Service.  The provisioning process gives
        an Account access to the Device.  See the next section on <a href=#device_provisioning>Device provisioning</a>.
    </p>

    <h3><a name=device_provisioning>Device Provisioning</a></h3>
    <p>
        For a Canopy-enabled device to connect to the Canopy Cloud Service, the
        device needs to be configured with the following information:
        <ul>
            <li>WiFi network SSID and passphrase (if WiFi is being used)</li>
            <li>Canopy Cloud Service hostname and port</li>
            <li>Canopy Cloud Service Account username and password</li>
            <li>Device UUID</li>
            <li>Device SDDL class</li>
        </ul>
    </p>
    <p>
        Configuration of these settings may be achieved using a micro SD card,
        or using an ad-hoc captive portal wifi network, or using some other
        mechanism.  This configuration is required, but the details of how it
        is achieved is outside the scope of this specification.
    </p>
    <p>
        Once a Canopy-enabled device has been configured and connects to the network, it begins
        communicating with the Canopy Cloud Service.  The very first time a
        device connects, the Canopy Cloud Service will perform the following actions:
        <ol>
            <li>A Device resource is created</li>
            <li>The configured Account is granted <a href=#permission_model>A2+S2 access</a> to the
            Device.</li>
        </ol>
    </p>
    <p>
        This process is called "Device Provisioning" and upon completion, the
        Device can be monitored, controlled, and shared by its owner.
    </p>

    <h3><a name=device_details>Device Details</a></h3>
    <h4>Request (Device Details)</h4>
    <p>
        To obtain information about a particular device:
    </p>
    <div class=code>GET /device/&lt;DEVICE_ID&gt;</div>
    <p>
        This request requires <a href=#permission_model><code>MONITOR_ONLY(A1)</code></a> access to the
        requested Device or higher.
    </p>

    <h4>Response (Device Details)</h4>
    <p>
        On success:
    </p>
    <div class=code>200 OK
{
    "device_id" : &lt;DEVICE_ID&gt;,
    "friendly_name" : &lt;FRIENDLY_NAME&gt;,
    "sddl_class" : &lt;SDDL_CLASS&gt;,
}</div>
    <p>
        A <a href=#not_found_error_response>"Not found" error response</a> is
        sent if any of the following are true:
        <ul>
            <li><code>&lt;DEVICE_ID&gt;</code> is not a valid Device ID.</li>
            <li>No Device is found with that ID.</li>
            <li>The currently signed-in Account does
                not have <a href=#permission_model><code>MONITOR_ONLY(A1)</code></a> or higher access to the Device.
            </li>
        </ul>
    </p>
    <p>
        If no Account is signed in: See <a href=..>Not logged-in error response</a>.
    </p>

    <h3><a name=controlling_a_device>Controlling a Device</a></h3>

    <h4>Request (Device Control)</h4>
    <p>
        Device control is performed by issuing "target" values for one or more
        control properties.
    </p>
    <div class=code>POST /device/&lt;DEVICE_ID&gt;/
{
    "__expiration_secs" : &lt;EXPIRATION_SECS&gt;

    &lt;PROPERTY_NAME_0&gt; : &lt;TARGET_VALUE&gt;,
    &lt;PROPERTY_NAME_1&gt; : &lt;TARGET_VALUE&gt;,
    ...
}</div>
    <p>
        <table class=paramtable>
            <tr>
                <th>Parameter</th>
                <th>Required</th>
                <th>Validation</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>&lt;EXPIRATION_SECS&gt;</td>
                <td>Optional</td>
                <td>null, or number.<br>Must be non-negative.</td>
                <td>Length of time for which this request is valid, starting
                from the time the request is processed by the server.  If null,
                the request never expires.  Defaults to null.
            </tr>
            <tr>
                <td>&lt;PROPERTY_NAME_<i>N</i>&gt; : &lt;TARGET_VALUE_<i>N</i>&gt;</td>
                <td>Optional</td>
                <td>&lt;PROPERTY_NAME_<i>i</i>&gt;: Must exactly match
                a control property id from the device's SDDL class.
                <br><br>
                &lt;TARGET_VALUE&gt;: Desired value for this control property.
                See <a href=validation_of_sddl_properties>Validation of SDDL properties</a> for more
                details.
                <td>Target value for the specified control property, replacing
                the previous target value for that property.</td>
            </tr>
        </table>
    </p>
    <p>
        This request requires <a href=#permission_model><code>MONITOR_AND_CONTROL(A2)</code></a> access to the
        requested Device.
    </p>
    <h4>Response (Device Control)</h4>
    <p>
        On success:
    </p>
    <div class=code>200 OK
{
    "result" : "ok"
}</div>

    <p>
        A <a href=#not_found_error_response>"Not found" error response</a> is
        sent if any of the following are true:
        <ul>
            <li><code>&lt;DEVICE_ID&gt;</code> is not a valid Device ID.</li>
            <li>No Device is found with that ID.</li>
            <li>The currently signed-in Account has
                <a href=#permission_model><code>NO_ACCESS(A0)</code></a> to the Device.
            </li>
        </ul>
    </p>
    <p>If the currently signed-in Account has 
        <a href=#permission_model><code>MONITOR_ONLY(A1)</code></a> access to the Device: See <a href=#insufficient_access_privileges_error_response>"Insufficient access privileges" error response</a>.
    <p>
        If no Account is signed in: See <a href=..>Not logged-in error response</a>.
    </p>
    <p>
        If one or more of the <code>&lt;PROPERTY_NAME_<i>N</i>&gt;</code> keys do not match a
        control property from the device's SDDL class:
    </p>
    <div class=code>403 FORBIDDEN
{
    "result" : "error",
    "error_type" : "invalid_control_property",
    "error_fields" : [&lt;PROPERTY_NAME_<i>i</i>&gt;, &lt;PROPERTY_NAME_<i>j</i>&gt;, ...]
}</div>

    <p>
        If one or more of the <code>&lt;TARGET_VALUE_<i>N</i>&gt;</code> values do not
        satisfy the validation criteria outlined in <a
        href=#validation_of_sddl_properties>Validation of SDDL properties</a>,
        or any other input validation error occurred: See <a href=validation_error_response>"Validation" error response</a>.
    </p>

    <h3><a name=fetching_historical_data>Fetching Historical Sensor or Control Data</a></h3>

    <h4>Request (Historic Data)</h4>
    <p>
        To fetch historic data for a sensor or control, use:
    </p>

    <div class=code>GET /device/&lt;DEVICE_ID&gt;/&lt;PROPERTY_NAME&gt;?
        begin_time=&lt;BEGIN_TIME&gt;
        &amp;end_time=&lt;END_TIME&gt;</div>
    <p>
        <table class=paramtable>
            <tr>
                <th>URL Parameter</th>
                <th>Required</th>
                <th>Validation</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>&lt;DEVICE_ID&gt;</td>
                <td>Required</td>
                <td>String UUID</td>
                <td>Device to get historic data for.</td>
            </tr>
            <tr>
                <td>&lt;PROPERTY_NAME&gt;</td>
                <td>Required</td>
                <td>String<bR>
                    Must match a device sensor or control property name from
                    device's SDDL class.</td>
                <td>Sensor or contol on the device to get historic data for.</td>
            </tr>
            <tr>
                <td>&lt;BEGIN_TIME&gt;</td>
                <td>Optional</td>
                <td>Datetime in RFC 3339 format</td>
                <td>If provided, only samples that were taken on or
                after the specified datetime are included in the results.</td>
            </tr>
            <tr>
                <td>&lt;END_TIME&gt;</td>
                <td>Optional</td>
                <td>Datetime in RFC 3339 format</td>
                <td>If provided, only samples that were taken before
                specified datetime are included in the results.</td>
            </tr>
        </table>
    </p>
    <p>
        This request requires <a href=#permission_model><code>MONITOR_ONLY(A1)</code></a> access to the
        requested Device or higher.
    </p>
    <h4>Response (Historic Data)</h4>
    <p>
        On success:
    </p>
    <div class=code>200 OK
{
    "result" : "ok",
    "samples" : [
        {
            "t" : &lt;SAMPLE_TIME_<i>0</i>&gt;,
            "v" : &lt;SAMPLE_VALUE_<i>0</i>&gt;
        }, {
            "t" : &lt;SAMPLE_TIME_<i>1</i>&gt;,
            "v" : &lt;SAMPLE_VALUE_<i>1</i>&gt;
        },
        ...
    ]
}</div>
    <p>
        A <a href=#not_found_error_response>"Not found" error response</a> is
        sent if any of the following are true:
        <ul>
            <li><code>&lt;DEVICE_ID&gt;</code> is not a valid Device ID.</li>
            <li>No Device is found with that ID.</li>
            <li>The currently signed-in Account does
                not have <a href=#permission_model><code>MONITOR_ONLY(A1)</code></a> or higher access to the Device.
            </li>
        </ul>
    </p>
    <p>
        If no Account is signed in: See <a href=..>Not logged-in error response</a>.
    </p>
    <p>
        If <code>&lt;PROPERTY_NAME&gt;</code> does not match a control or sensor property from the device's SDDL class:
    </p>
    <div class=code>404 NOT FOUND
{
    "result" : "error",
    "error_type" : "invalid_property",
    "error_properties" : [&lt;PROPERTY_NAME&gt;]
}</div>

    <h2><a name=devices_aliases>Device Aliases</a></h2>
    <p>
        A Device Alias is a short, semi-custom URL for accessing device
        endpoints.
    </p>
    <p>
        A Device Alias is a subresouce of an Account.  Thus, two or more
        Accounts may have different Device Aliases that refer to the same
        underlying Device.
    </p>
    <p>
        The regular URL for a Device resource has the following form:
    </p>
    <div class=code>/device/&lt;DEVICE_ID&gt;</div>
    <p>
        An Alias URL has this simpler form::
    </p>
    <div class=code>/&lt;ACCOUNT_USERNAME&gt;/&lt;DEVICE_ALIAS_NAME&gt;</div>
    <p>
        Or, using the <code>/my</code> shortcut for the currently-signed-in
        user:
    </p>
    <div class=code>/my/&lt;DEVICE_ALIAS_NAME&gt;</div>
    <p>
        For example:<br>
        User <b>leela</b> owns a smart toaster:
    </p>
    <div class=code>http://sandbox.canopy.link/devices/7fe620c0-e5bb-11e3-ac10-0800200c9a66</div>
    <p>
        Leela creates an alias for the smart toaster:
    </p>
    <div class=code>http://sandbox.canopy.link/leela/toaster</div>
    <p>
        If Leela is logged in, she can simply use:
    </p>
    <div class=code>http://sandbox.canopy.link/my/toaster</div>
    <p>
        If <b>leela</b> shares the toaster with user <b>fry</b>, he can
        access it from either of the following URLs:
    </p>
    <div class=code>http://sandbox.canopy.link/devices/7fe620c0-e5bb-11e3-ac10-0800200c9a66A
    OR
http://sandbox.canopy.link/leela/toaster</div>
    <p>
        The user <b>fry</b> can create his own alias for the toaster:
    </p>
    <div class=code>http://sandbox.canopy.link/fry/leela_toaster</div>
    <p>
        Or, if <b>fry</b> is logged in:
    </p>
    <div class=code>http://sandbox.canopy.link/my/leela_toaster</div>
    

    <h3><a name=creating_a_device_alias>Creating a Device Alias</a></h3>

    <h4>Request (Create Device Alias)</h4>
    <p>
        To create a device alias use:
    </p>
    <div class=code>POST /&lt;ACCOUNT_USERNAME&gt;/__aliases
{
    "device_id" : &lt;DEVICE_ID&gt;,
    "alias" : &lt;ALIAS&gt;
}</div>

    <p>
        <table class=paramtable>
            <tr>
                <th>Parameter</th>
                <th>Required</th>
                <th>Validation</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>&lt;DEVICE_ID&gt;</td>
                <td>Required</td>
                <td>String UUID</td>
                <td>Device to create Alias for.</td>
            </tr>
                <td>&lt;ALIAS&gt;</td>
                <td>Required</td>
                <td>String.<br>^[0-9A-Za-z_-]{1,32}$</td>
                <td>Alias name for the device.</td>
            </tr>
        </table>
    </p>
    <p>
        This request requires <a href=#permission_model><code>MONITOR_ONLY(A1)</code></a> access to the
        requested Device or higher.
    </p>
    <p>
        This request requires that <code>&lt;ACCOUNT_USERNAME&gt;</code> is the currently signed-in account.
    </p>

    <h3><a name=deleting_a_device_alias>Deleting a Device Alias</a></h3> 
    <p>
        A Device Alias will automatically be deleted if the underlying Device
        resource is deleted.  Additionally, a Device resource may be deleted
        manually.
    </p>

    <h4>Request (Delete Device Alias)</h4>
    <p>
        To delete a device alias use:
    </p>
    <div class=code>DELETE /&lt;ACCOUNT_USERNAME&gt;/__aliases/&lt;ALIAS&gt;</div>
    <p>
        This request requires that <code>&lt;ACCOUNT_USERNAME&gt;</code> is the currently signed-in account.
    </p>


    <h2><a name=deleting_a_device_alias>Device permissions and sharing</a></h2> 
    <p>
    </p>

    <h3><a name=sharing_a_device>Sharing a Device</a></h2> 

    <h4>Request (Sharing A Device)</h4>
    <p>
        Multiple Accounts can be granted access and/or sharing privileges for multiple Devices
        with a single API call:
    </p>
    <div class=code>POST /permissions
{
    "set_permissions" : [
        {
            "account" : &lt;ACCOUNT_USERNAME_OR_EMAIL_<i>0</i>&gt;,
            "device_id" : &lt;DEVICE_ID_<i>0</i>&gt;,,
            "access_level" : &lt;ACCESS_LEVEL_<i>0</i>&gt;,
            "sharing_level" : &lt;SHARING_LEVEL_<i>0</i>&gt;
        },
        {
            "account" : &lt;ACCOUNT_USERNAME_OR_EMAIL_<i>1</i>&gt;,
            "device_id" : &lt;DEVICE_ID_<i>1</i>&gt;,,
            "access_level" : &lt;ACCESS_LEVEL_<i>1</i>&gt;,
            "sharing_level" : &lt;SHARING_LEVEL_<i>1</i>&gt;
        },
        ...
    ]
}</div>

    <p>
        <table class=paramtable>
            <tr>
                <th>Parameter</th>
                <th>Required</th>
                <th>Validation</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>&lt;ACCOUNT_USERNAME_OR_EMAIL_<i>N</i>&gt;</td>
                <td>Required</td>
                <td>String</td>
                <td>Username or email address of Account to change permissions for.</td>
            </tr>
            <tr>
                <td>&lt;DEVICE_ID_<i>N</i>&gt;</td>
                <td>Required</td>
                <td>String UUID</td>
                <td>Device for which access is being granted or revoked.</td>
            </tr>
            <tr>
                <td>&lt;ACCESS_LEVEL_<i>N</i>&gt;</td>
                <td>Optional</td>
                <td>String
                    <br>Must be one of the following:
                    <ul>
                        <li>"no_access"
                        <li>"monitor_only"
                        <li>"monitor_and_control"
                    </ul>
                </td>
                <td>Access privilege level for Account to monitor and
                control Device.  See <a href=#device_access_permissions>Device
                access permissions</a> for more details.  If omitted, will
                remain unchanged.
                </td>
            </tr>
            <tr>
                <td>&lt;SHARING_LEVEL_<i>N</i>&gt;</td>
                <td>Optional</td>
                <td>String
                    <br>Must be one of the following:
                    <ul>
                        <li>"no_sharing"
                        <li>"share_only"
                        <li>"share_and_revoke"
                    </ul>
                </td>
                <td>Sharing privilege level for Account to modify permissions
                of Device.  See <a href=#device_sharing_permissions>Device
                sharing permissions</a> for more details.  If omitted, will
                remain unchanged.
                </td>
            </tr>
        </table>
    </p>
    <p>
        The <code>"set_permission"</code> list may contain any number of
        entries.  For each entry, access and sharing privileges are updated
        for the specified Account and Device.
    </p>

    <h4>Response (Sharing A Device)</h4>
    <p>
        The Canopy Web Service will attempt to set each of the requested
        permissions independantly.  That is, in most cases, a failure to apply
        one <code>"set_permission"</code> entry will not prevent the other
        <code>"set_permission"</code> entries from being applied.  If ALL
        <code>"set_permission"</code> entries are applied successfully, the
        response is:
    </p>
    <div class=code>200 OK
{
    "result" : "ok",
}</div>
    <p>
        If one or more non-fatal errors occur, the response will still send
        status code <code>200 OK</code> and will include <code>"result" :
        "ok"</code>, but additionally will include details about the errors
        that occurred.
    </p>

    <p>
        If the Account making the request does not have permission to grant
        access to a Device, it is reported as follows:
    </p>

    <div class=code>200 OK
{
    "result" : "ok",
    "errors" : [
        {
            "error_type" : "insufficient_sharing_privileges",
            "account" : &lt;ACCOUNT_USERNAME_OR_EMAIL&gt;,
            "device_id" : &lt;DEVICE_ID&gt;,
            "requested_access_level" : &lt;ACCESS_LEVEL&gt;,
            "requested_sharing_level" : &lt;SHARING_LEVEL&gt;
        },
        ...
    ]
}</div>

    <p>
        This warning is generated if any of the following are true:
        <ul>
            <li>The requester has <code>NO_SHARING(0)</code> sharing privileges
                for the requested Device.
            </li>
            <li>The requested <code>"access_level"</code> is higher than the
                requester's own access level for the requested Device.
            </li>
            <li>The requested <code>"sharing_level"</code> is higher than the
                requester's own sharing level for the requested Device.
            </li>
            <li>The requester has <code>SHARE_ONLY(1)</code> sharing privileges
            and <code>"access_level"</code> is lower than the target Account's
            current access level.
            </li>
            <li>The requester has <code>SHARE_ONLY(1)</code> sharing privileges
            and <code>"sharing_level"</code> is lower than the target Account's
            current sharing level.
            </li>
            <li>The requester has <code>SHARE_AND_REVOKE(2)</code> sharing privileges
            and the target Account's current access level is above the
            requester's current access level for the requested Device.
            </li>
            <li>The requester has <code>SHARE_AND_REVOKE(2)</code> sharing privileges
            and the target Account's current sharing level is above the
            requester's current sharing level for the requested Device.
            </li>
        </ul>
    </p>

    <p>
        If an <code>&lt;ACCOUNT_USERNAME_OR_EMAIL_<i>N</i>&gt;</code> value does not correspond to an
        Account, it is reported as follows:
    </p>
    <div class=code>200 OK
{
    "errors" : [
        {
            "error_type" : "account_not_found",
            "account" : &lt;ACCOUNT_USERNAME_OR_EMAIL&gt;,
            "device_id" : &lt;DEVICE_ID&gt;,
            "requested_access_level" : &lt;ACCESS_LEVEL&gt;,
            "requested_sharing_level" : &lt;SHARING_LEVEL&gt;
        },
        ...
    ]
}</div>

    <p>
        If a <code>&lt;DEVICE_ID_<i>N</i>&gt;</code> value does not correspond to a
        Device, it is reported as follows:
    </p>
    <div class=code>200 OK
{
    "errors" : [
        {
            "error_type" : "device_not_found",
            "account" : &lt;ACCOUNT_USERNAME_OR_EMAIL&gt;,
            "device_id" : &lt;DEVICE_ID&gt;,
            "requested_access_level" : &lt;ACCESS_LEVEL&gt;,
            "requested_sharing_level" : &lt;SHARING_LEVEL&gt;
        },
        ...
    ]
}</div>

    <p>
        If input validation fails within an <code>"set_permissions"</code>
        entry, it is reported as follows:
    </p>
    <div class=code>200 OK
{
    "errors" : [
        {
            "error_type" : "input_validation_error",
            "error_field" : &lt;ERROR_FIELD&gt;,
            "account" : &lt;ACCOUNT_USERNAME_OR_EMAIL&gt;,
            "device_id" : &lt;DEVICE_ID&gt;,
            "requested_access_level" : &lt;ACCESS_LEVEL&gt;,
            "requested_sharing_level" : &lt;SHARING_LEVEL&gt;
        },
        ...
    ]
}</div>
    <h3><a name=revoking_access_to_a_device>Revoking access to a Device</a></h3>
    <p>
        Revoking another Account's access to a Device is simply a matter of
        lowering the Account's access privilege to <code>NO_ACCESS(0)</code>.
        For example, to revoke a single Account's access to a single Device,
        you would use:
    <div class=code>POST /permissions
{
    "set_permissions" : [ {
        "account" : &lt;ACCOUNT_USERNAME_OR_EMAIL&gt;,
        "device_id" : &lt;DEVICE_ID&gt;,
        "access_level" : "no_access",
        "sharing_level" : "no_sharing"
    } ]
}</div>
    </p>

    <h3><a name=seeing_who_can_access_a_device>Seeing who can access a Device</a><h3>
    <h4>Request (Device Permission Details)</h4>
    <p>
        To discover who has access to a Device, use:
    </p>
    <div class=code>GET /devices/&lt;DEVICE_ID&gt;/__permissions</div>
    <p>
        This request requires <a href=#permission_model><code>MONITOR_ONLY(A1)</code></a> or higher access to the requested Device.
    </p>

    <h4>Response (Device Permission Details)</h4>
    <p>
        On success, the result will include all Accounts with access level <code>MONITOR_ONLY(A1)</code> or higher:
    </p>
    <div class=code>200 OK
{
    "permissions" : [
        {
            "account" : &lt;ACCOUNT_USERNAME&gt;,
            "access_level" : &lt;ACCESS_LEVEL&gt;,
            "sharing_level" : &lt;SHARING_LEVEL&gt;
        },
        ...
    ]
}</div>


    <p>
        <center>
        The content of this page is licensed under the Creative Commons Attribution 3.0 License, and code is licensed under a BSD license.
    </p>
</div>
</body>
</html>

<!--
TODO:
- Permissions
- Errors
- Events
-->
